

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>src package &mdash; Bayesian MCMC Framework 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=f2a433a1"></script>
      <script src="_static/doctools.js?v=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Bayesian-Markov-chain-Monte-Carlo" href="modules.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Bayesian MCMC Framework
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Python API:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Bayesian-Markov-chain-Monte-Carlo</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">src package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-src.MCMC">src.MCMC module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.MCMC.MCMC"><code class="docutils literal notranslate"><span class="pre">MCMC</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-src.RSF">src.RSF module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.RSF.RSF"><code class="docutils literal notranslate"><span class="pre">RSF</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.RSF.measure_execution_time"><code class="docutils literal notranslate"><span class="pre">measure_execution_time()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-src.RateStateModel">src.RateStateModel module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.RateStateModel.RateStateModel"><code class="docutils literal notranslate"><span class="pre">RateStateModel</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-src.imports">src.imports module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-src.json_save_load">src.json_save_load module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.json_save_load.load_object"><code class="docutils literal notranslate"><span class="pre">load_object()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.json_save_load.numpy_array_decoder"><code class="docutils literal notranslate"><span class="pre">numpy_array_decoder()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.json_save_load.numpy_array_encoder"><code class="docutils literal notranslate"><span class="pre">numpy_array_encoder()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.json_save_load.save_object"><code class="docutils literal notranslate"><span class="pre">save_object()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-src.main">src.main module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.main.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.main.perform_inference"><code class="docutils literal notranslate"><span class="pre">perform_inference()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.main.setup_problem"><code class="docutils literal notranslate"><span class="pre">setup_problem()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-src.mysql_save_load">src.mysql_save_load module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.mysql_save_load.load_object"><code class="docutils literal notranslate"><span class="pre">load_object()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.mysql_save_load.save_object"><code class="docutils literal notranslate"><span class="pre">save_object()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-src.setup_path">src.setup_path module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-src">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Bayesian MCMC Framework</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">Bayesian-Markov-chain-Monte-Carlo</a></li>
      <li class="breadcrumb-item active">src package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/src.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="src-package">
<h1>src package<a class="headerlink" href="#src-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-src.MCMC">
<span id="src-mcmc-module"></span><h2>src.MCMC module<a class="headerlink" href="#module-src.MCMC" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="src.MCMC.MCMC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.MCMC.</span></span><span class="sig-name descname"><span class="pre">MCMC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dc_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qpriors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qstart</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lstm_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adapt_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/MCMC.html#MCMC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.MCMC.MCMC" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Adaptive Metropolis-Hastings Markov Chain Monte Carlo (MCMC) sampler.</p>
<p>This class implements an adaptive MCMC algorithm for Bayesian parameter estimation.
It uses the Metropolis-Hastings algorithm with adaptive covariance matrix updates
to improve sampling efficiency. The algorithm is particularly suited for sampling
from posterior distributions in inverse problems where direct sampling is difficult.</p>
<p>The adaptive feature automatically adjusts the proposal covariance matrix during
sampling to achieve better acceptance rates and mixing. The algorithm also
incorporates hierarchical Bayesian modeling by updating the noise variance
(standard deviation) at each step.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="src.MCMC.MCMC.model">
<span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#src.MCMC.MCMC.model" title="Link to this definition"></a></dt>
<dd><p>The forward model used for evaluation</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.MCMC.MCMC.qstart">
<span class="sig-name descname"><span class="pre">qstart</span></span><a class="headerlink" href="#src.MCMC.MCMC.qstart" title="Link to this definition"></a></dt>
<dd><p>Initial parameter value for sampling</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.MCMC.MCMC.qpriors">
<span class="sig-name descname"><span class="pre">qpriors</span></span><a class="headerlink" href="#src.MCMC.MCMC.qpriors" title="Link to this definition"></a></dt>
<dd><p>Prior parameter bounds and information</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.MCMC.MCMC.nsamples">
<span class="sig-name descname"><span class="pre">nsamples</span></span><a class="headerlink" href="#src.MCMC.MCMC.nsamples" title="Link to this definition"></a></dt>
<dd><p>Total number of MCMC samples to generate</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.MCMC.MCMC.nburn">
<span class="sig-name descname"><span class="pre">nburn</span></span><a class="headerlink" href="#src.MCMC.MCMC.nburn" title="Link to this definition"></a></dt>
<dd><p>Number of burn-in samples to discard</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.MCMC.MCMC.verbose">
<span class="sig-name descname"><span class="pre">verbose</span></span><a class="headerlink" href="#src.MCMC.MCMC.verbose" title="Link to this definition"></a></dt>
<dd><p>Whether to print diagnostic information</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.MCMC.MCMC.adapt_interval">
<span class="sig-name descname"><span class="pre">adapt_interval</span></span><a class="headerlink" href="#src.MCMC.MCMC.adapt_interval" title="Link to this definition"></a></dt>
<dd><p>Frequency of covariance matrix adaptation</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.MCMC.MCMC.data">
<span class="sig-name descname"><span class="pre">data</span></span><a class="headerlink" href="#src.MCMC.MCMC.data" title="Link to this definition"></a></dt>
<dd><p>Observed data for comparison</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.MCMC.MCMC.lstm_model">
<span class="sig-name descname"><span class="pre">lstm_model</span></span><a class="headerlink" href="#src.MCMC.MCMC.lstm_model" title="Link to this definition"></a></dt>
<dd><p>Optional LSTM model configuration</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.MCMC.MCMC.n0">
<span class="sig-name descname"><span class="pre">n0</span></span><a class="headerlink" href="#src.MCMC.MCMC.n0" title="Link to this definition"></a></dt>
<dd><p>Prior shape parameter for noise variance</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.MCMC.MCMC.qstart_limits">
<span class="sig-name descname"><span class="pre">qstart_limits</span></span><a class="headerlink" href="#src.MCMC.MCMC.qstart_limits" title="Link to this definition"></a></dt>
<dd><p>Parameter bounds for acceptance</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.MCMC.MCMC.dc_true">
<span class="sig-name descname"><span class="pre">dc_true</span></span><a class="headerlink" href="#src.MCMC.MCMC.dc_true" title="Link to this definition"></a></dt>
<dd><p>True parameter value (for comparison/validation)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.MCMC.MCMC.std2">
<span class="sig-name descname"><span class="pre">std2</span></span><a class="headerlink" href="#src.MCMC.MCMC.std2" title="Link to this definition"></a></dt>
<dd><p>Evolution of noise variance estimates</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.MCMC.MCMC.Vstart">
<span class="sig-name descname"><span class="pre">Vstart</span></span><a class="headerlink" href="#src.MCMC.MCMC.Vstart" title="Link to this definition"></a></dt>
<dd><p>Initial covariance matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Setup model and data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MyForwardModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">priors</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">}</span>  <span class="c1"># lower_bound, upper_bound</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Initialize MCMC sampler</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mcmc</span> <span class="o">=</span> <span class="n">MCMC</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">dc_true</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">qpriors</span><span class="o">=</span><span class="n">priors</span><span class="p">,</span> <span class="n">qstart</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">nsamples</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Run sampling</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="n">mcmc</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">MAKE_ANIMATIONS</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Posterior mean: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="src.MCMC.MCMC.SSqcalc">
<span class="sig-name descname"><span class="pre">SSqcalc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_new</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/MCMC.html#MCMC.SSqcalc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.MCMC.MCMC.SSqcalc" title="Link to this definition"></a></dt>
<dd><p>Calculate the sum of squared errors for proposed parameter values.</p>
<p>This method evaluates the forward model with new parameter values and
computes the sum of squared errors between model predictions and observed data.
This quantity is used in the likelihood calculation for the Metropolis-Hastings
acceptance criterion.</p>
<p>The sum of squared errors (SSE) is a key component of the Gaussian likelihood:
L(θ) ∝ exp(-SSE/(2σ²))
where SSE = Σ(y_i - f(x_i, θ))²</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>q_new</strong> (<em>np.ndarray</em>) – Proposed parameter values with shape (n_params,).
For this implementation, expects a 1D array where
the first element is the Dc parameter.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Sum of squared errors with shape (1, 1).</dt><dd><p>Returns as 2D array for consistency with matrix operations.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>Process:</dt><dd><ol class="arabic simple">
<li><p>Update the model’s Dc parameter with the proposed value</p></li>
<li><p>Evaluate the forward model to get predictions</p></li>
<li><p>Reshape predictions to match data format</p></li>
<li><p>Compute squared differences between predictions and data</p></li>
<li><p>Sum the squared errors and return as 2D array</p></li>
</ol>
</dd>
<dt>Mathematical Details:</dt><dd><ul class="simple">
<li><p>SSE = Σᵢ (yᵢ - f(xᵢ, θ))²</p></li>
<li><p>Where yᵢ are observations, f(xᵢ, θ) are model predictions</p></li>
<li><p>Used in Gaussian log-likelihood: log L = -n/2 log(2πσ²) - SSE/(2σ²)</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Modifies self.model.Dc as a side effect</p></li>
<li><p>Assumes model.evaluate() returns predictions in appropriate format</p></li>
<li><p>Reshaping handles potential dimension mismatches between predictions and data</p></li>
<li><p>The keepdims parameter ensures output maintains 2D structure</p></li>
</ul>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSqcalc</span><span class="p">(</span><span class="n">q_test</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sum of squared errors: </span><span class="si">{</span><span class="n">sse</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.MCMC.MCMC.acceptreject">
<span class="sig-name descname"><span class="pre">acceptreject</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_new</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SSqprev</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/MCMC.html#MCMC.acceptreject"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.MCMC.MCMC.acceptreject" title="Link to this definition"></a></dt>
<dd><p>Implement the Metropolis-Hastings acceptance/rejection criterion.</p>
<p>This method determines whether to accept or reject a proposed parameter sample
based on the Metropolis-Hastings algorithm. It first checks if the proposal
falls within the prior bounds, then computes the acceptance probability based
on the likelihood ratio, and finally makes a random decision.</p>
<p>The acceptance probability is computed in log-space for numerical stability:
log(α) = min(0, log(p(y|θ_new)/p(y|θ_old)))</p>
<blockquote>
<div><p>= min(0, -0.5 * (SSE_new - SSE_old) / σ²)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_new</strong> (<em>np.ndarray</em>) – Proposed parameter values with shape (n_params, 1).</p></li>
<li><p><strong>SSqprev</strong> (<em>float</em>) – Sum of squared errors for the current/previous parameter values.</p></li>
<li><p><strong>std2</strong> (<em>float</em>) – Current estimate of the noise variance.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing:</dt><dd><ul class="simple">
<li><p>accept (bool): True if the proposal is accepted, False otherwise</p></li>
<li><dl class="simple">
<dt>SSq (float): Sum of squared errors for the accepted state</dt><dd><p>(SSqnew if accepted, SSqprev if rejected)</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<dl class="simple">
<dt>Algorithm Steps:</dt><dd><ol class="arabic simple">
<li><p>Check if proposal is within prior bounds (uniform prior)</p></li>
<li><p>If within bounds, evaluate model and compute likelihood ratio</p></li>
<li><p>Compute log acceptance probability (clipped to [-∞, 0])</p></li>
<li><p>Accept if log(α) &gt; log(U) where U ~ Uniform(0,1)</p></li>
<li><p>Return acceptance decision and appropriate SSE value</p></li>
</ol>
</dd>
<dt>Mathematical Details:</dt><dd><ul class="simple">
<li><p>Prior bounds check: lower_bound ≤ θ_new ≤ upper_bound</p></li>
<li><p>Log-likelihood ratio: Δ log L = -0.5 * (SSE_new - SSE_old) / σ²</p></li>
<li><p>Acceptance probability: α = min(1, exp(Δ log L))</p></li>
<li><p>Random acceptance: Accept if α &gt; U where U ~ Uniform(0,1)</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Uses np.clip to ensure log probability doesn’t exceed 0</p></li>
<li><p>Proposals outside prior bounds are automatically rejected</p></li>
<li><p>The method handles both parameter bounds and likelihood evaluation</p></li>
<li><p>Random number generation uses np.random.rand() for uniform samples</p></li>
</ul>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q_proposal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.5</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">accepted</span><span class="p">,</span> <span class="n">sse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">acceptreject</span><span class="p">(</span><span class="n">q_proposal</span><span class="p">,</span> <span class="n">sse_current</span><span class="p">,</span> <span class="n">variance_current</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">accepted</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accepted proposal with SSE: </span><span class="si">{</span><span class="n">sse</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.MCMC.MCMC.compute_initial_covariance">
<span class="sig-name descname"><span class="pre">compute_initial_covariance</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/MCMC.html#MCMC.compute_initial_covariance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.MCMC.MCMC.compute_initial_covariance" title="Link to this definition"></a></dt>
<dd><p>Compute the initial proposal covariance matrix using finite differences.</p>
<p>This method estimates the initial covariance matrix for MCMC proposals by
computing a finite difference approximation of the Hessian matrix. The approach
perturbs the initial parameter guess and evaluates how the model response changes,
providing information about the local curvature of the posterior distribution.</p>
<p>The method performs the following steps:
1. Evaluates the model at the initial parameter guess
2. Perturbs the parameter by a small amount (1e-6 relative)
3. Re-evaluates the model with the perturbed parameter
4. Computes finite difference approximation of the gradient
5. Estimates the Hessian and its inverse for the covariance matrix
6. Scales by the noise variance estimate</p>
<dl class="simple">
<dt>Updates:</dt><dd><p>self.std2 (list): Initializes with the noise variance estimate from residuals
self.Vstart (np.ndarray): Initial covariance matrix for proposals</p>
</dd>
<dt>Mathematical Details:</dt><dd><ul class="simple">
<li><p>Finite difference gradient: g ≈ (f(x+δ) - f(x)) / δ</p></li>
<li><p>Hessian approximation: H ≈ g^T * g (Gauss-Newton approximation)</p></li>
<li><p>Initial covariance: V₀ = σ² * H⁻¹</p></li>
<li><p>Noise variance: σ² = SSE / (n - p) where n=data points, p=parameters</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Uses a relative perturbation of 1e-6 for finite differences</p></li>
<li><p>The noise variance is estimated from the initial residuals</p></li>
<li><p>This provides a reasonable starting point for the adaptive algorithm</p></li>
<li><p>The method assumes the posterior is approximately Gaussian locally</p></li>
</ul>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mcmc</span><span class="o">.</span><span class="n">compute_initial_covariance</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Initial noise variance: </span><span class="si">{</span><span class="n">mcmc</span><span class="o">.</span><span class="n">std2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Initial covariance shape: </span><span class="si">{</span><span class="n">mcmc</span><span class="o">.</span><span class="n">Vstart</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.MCMC.MCMC.evaluate_model">
<span class="sig-name descname"><span class="pre">evaluate_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/MCMC.html#MCMC.evaluate_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.MCMC.MCMC.evaluate_model" title="Link to this definition"></a></dt>
<dd><p>Evaluate the forward model for current parameter values.</p>
<p>This method provides a unified interface for model evaluation, automatically
selecting between full model evaluation and reduced-order model (ROM) evaluation
based on whether an LSTM model is provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Model predictions/outputs for the current parameter values.</dt><dd><p>The specific format depends on the model implementation.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>If lstm_model is provided and non-empty, uses ROM evaluation</p></li>
<li><p>Otherwise uses standard model evaluation</p></li>
<li><p>The model’s ‘Dc’ attribute should be set before calling this method</p></li>
</ul>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">Dc</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluate_model</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.MCMC.MCMC.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MAKE_ANIMATIONS</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/MCMC.html#MCMC.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.MCMC.MCMC.sample" title="Link to this definition"></a></dt>
<dd><p>Execute the main MCMC sampling algorithm with adaptive covariance updates.</p>
<p>This method implements the complete adaptive Metropolis-Hastings algorithm,
including initialization, proposal generation, acceptance/rejection decisions,
covariance matrix adaptation, and noise variance updates. Optionally creates
real-time animations of the sampling process.</p>
<p>The algorithm follows these key steps:
1. Initialize covariance matrix using finite differences
2. For each iteration:</p>
<blockquote>
<div><ul class="simple">
<li><p>Generate proposal from multivariate normal distribution</p></li>
<li><p>Apply Metropolis-Hastings acceptance criterion</p></li>
<li><p>Update noise variance using Bayesian inference</p></li>
<li><p>Periodically adapt the proposal covariance matrix</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Return samples after burn-in period</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>MAKE_ANIMATIONS</strong> (<em>bool</em>) – Whether to create and save real-time animations
of the sampling evolution. Animations are saved as
MP4 files with filenames including the true parameter value.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Array of accepted parameter samples after burn-in with shape</dt><dd><p>(n_params, n_samples_post_burnin). Only samples after the burn-in
period are returned for posterior analysis.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>Algorithm Details:</dt><dd><ul class="simple">
<li><p>Proposal generation: θ_new ~ N(θ_current, V_current)</p></li>
<li><p>Acceptance rate tracking for diagnostic purposes</p></li>
<li><p>Adaptive covariance updates every ‘adapt_interval’ samples</p></li>
<li><p>Hierarchical variance updates at each iteration</p></li>
<li><p>Burn-in removal for final sample return</p></li>
</ul>
</dd>
<dt>Animation Features (if MAKE_ANIMATIONS=True):</dt><dd><ul class="simple">
<li><p>Real-time plot of parameter evolution</p></li>
<li><p>Automatic axis scaling based on sample range</p></li>
<li><p>Saved as MP4 with 30 fps using ffmpeg</p></li>
<li><p>Filename includes true parameter value for identification</p></li>
</ul>
</dd>
<dt>Diagnostic Output:</dt><dd><ul class="simple">
<li><p>Sample index and acceptance status for each iteration</p></li>
<li><p>Generated sample values for monitoring</p></li>
<li><p>Final acceptance ratio for algorithm assessment</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Burn-in period is automatically set to nsamples/2</p></li>
<li><p>Failed covariance updates are caught and ignored</p></li>
<li><p>Animation requires matplotlib and ffmpeg</p></li>
<li><p>Memory is managed by closing figure after animation</p></li>
</ul>
</div>
<dl class="simple">
<dt>Performance Tips:</dt><dd><ul class="simple">
<li><p>Set adapt_interval appropriately (typically 10-50)</p></li>
<li><p>Monitor acceptance ratio (target ~20-50%)</p></li>
<li><p>Use sufficient burn-in for convergence</p></li>
<li><p>Consider thinning for large sample sizes</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Run MCMC with animations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="n">mcmc</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">MAKE_ANIMATIONS</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Collected </span><span class="si">{</span><span class="n">samples</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> post-burn-in samples&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Posterior mean: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span><span class="w"> </span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Posterior std: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span><span class="w"> </span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>Parameter estimation (posterior mean, median)</p></li>
<li><p>Uncertainty quantification (credible intervals)</p></li>
<li><p>Model comparison (marginal likelihood estimation)</p></li>
<li><p>Diagnostic analysis (convergence assessment)</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>The method returns samples from the posterior distribution that can be used for</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.MCMC.MCMC.update_covariance_matrix">
<span class="sig-name descname"><span class="pre">update_covariance_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qparams</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/MCMC.html#MCMC.update_covariance_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.MCMC.MCMC.update_covariance_matrix" title="Link to this definition"></a></dt>
<dd><p>Update the proposal covariance matrix for adaptive MCMC.</p>
<p>This method implements the adaptive Metropolis algorithm by updating the
proposal covariance matrix based on the sample covariance of recent parameter
samples. This adaptation improves the efficiency of the MCMC sampler by
learning the appropriate scale and orientation for proposals.</p>
<p>The method follows the optimal scaling theory for MCMC, using:
- Scaling factor: (2.38)²/d where d is the dimension
- Sample covariance from the last ‘adapt_interval’ samples
- Cholesky decomposition for numerical stability in proposal generation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>qparams</strong> (<em>np.ndarray</em>) – Array of parameter samples with shape (n_params, n_samples).
The method uses only the last ‘adapt_interval’ samples
for covariance estimation.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Lower triangular Cholesky factor of the updated covariance matrix.</dt><dd><p>Used for generating correlated proposals via matrix multiplication.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>LinAlgError</strong> – If the sample covariance matrix is not positive definite.
    This can happen with insufficient samples or highly correlated chains.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>The 2.38² scaling ensures optimal acceptance rate (~23.4%) for Gaussian targets</p></li>
<li><p>For 1D problems, the covariance is reshaped to maintain matrix structure</p></li>
<li><p>The Cholesky factor is returned for efficient proposal generation</p></li>
<li><p>Adaptation should only occur after sufficient samples for stable covariance estimation</p></li>
</ul>
</div>
<dl class="simple">
<dt>Mathematical Details:</dt><dd><ul class="simple">
<li><p>Optimal covariance: C_opt = (2.38²/d) * Σ_sample</p></li>
<li><p>Where Σ_sample is the empirical covariance of recent samples</p></li>
<li><p>Cholesky decomposition: C_opt = L * L^T</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.MCMC.MCMC.update_standard_deviation">
<span class="sig-name descname"><span class="pre">update_standard_deviation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">SSqprev</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/MCMC.html#MCMC.update_standard_deviation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.MCMC.MCMC.update_standard_deviation" title="Link to this definition"></a></dt>
<dd><p>Update the noise variance estimate using Bayesian inference.</p>
<p>This method implements a hierarchical Bayesian approach where the noise
variance (standard deviation squared) is treated as an unknown parameter
with an inverse-gamma prior. The posterior is also inverse-gamma distributed,
allowing for analytical updates.</p>
<p>The update follows the inverse-gamma conjugate prior framework:
- Prior: σ² ~ InverseGamma(n0/2, n0*σ0²/2)
- Posterior: σ² ~ InverseGamma((n0+n)/2, (n0*σ0² + SSE)/2)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>SSqprev</strong> (<em>float</em>) – Sum of squared errors for the current parameter values.
Used to update the scale parameter of the inverse-gamma
distribution.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Updates self.std2 list with new variance sample</p></li>
<li><p>Uses the previous variance estimate (self.std2[-1]) in the update</p></li>
<li><p>The variance sample is drawn from the posterior distribution</p></li>
<li><p>Accept/reject criterion depends on this updated standard deviation</p></li>
</ul>
</div>
<dl class="simple">
<dt>Mathematical Details:</dt><dd><ul class="simple">
<li><p>Shape parameter: a = (n0 + len(data)) / 2</p></li>
<li><p>Scale parameter: b = (n0 * previous_variance + SSE) / 2</p></li>
<li><p>New variance: σ² ~ InverseGamma(a, b)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-src.RSF">
<span id="src-rsf-module"></span><h2>src.RSF module<a class="headerlink" href="#module-src.RSF" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="src.RSF.RSF">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.RSF.</span></span><span class="sig-name descname"><span class="pre">RSF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">number_slip_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowest_slip_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">largest_slip_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qstart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qpriors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['Uniform',</span> <span class="pre">0.0,</span> <span class="pre">10000.0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotfigs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/RSF.html#RSF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.RSF.RSF" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Driver class for Rate and State Friction (RSF) model analysis and parameter estimation.</p>
<p>This class provides a comprehensive framework for analyzing rate and state friction
models through forward modeling, data generation, and Bayesian parameter estimation
using Markov Chain Monte Carlo (MCMC) methods. It handles multiple characteristic
slip distances (Dc values) and supports various data storage formats.</p>
<p>The class integrates several key components:
- Forward modeling with rate and state friction physics
- Synthetic data generation with realistic noise models
- Bayesian parameter estimation using adaptive MCMC
- Data persistence through JSON and MySQL backends
- Comprehensive visualization and analysis tools
- Performance monitoring and optimization</p>
<p>Key Features:
- Multi-parameter sweep capabilities across Dc values
- Flexible prior specification for Bayesian inference
- Automated plotting and visualization
- Data format abstraction (JSON/MySQL)
- Execution time monitoring
- Model reduction options for computational efficiency</p>
<p>Workflow:
1. Initialize with parameter ranges and inference settings
2. Generate synthetic time series data across parameter space
3. Store data using preferred backend (JSON/MySQL)
4. Perform MCMC parameter estimation for each Dc value
5. Visualize posterior distributions and convergence diagnostics</p>
<p>Applications:
- Earthquake fault parameter estimation from seismic data
- Laboratory friction experiment analysis
- Model validation and uncertainty quantification
- Parameter sensitivity studies
- Computational method benchmarking</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="src.RSF.RSF.num_dc">
<span class="sig-name descname"><span class="pre">num_dc</span></span><a class="headerlink" href="#src.RSF.RSF.num_dc" title="Link to this definition"></a></dt>
<dd><p>Number of characteristic slip distance values to analyze</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.RSF.RSF.dc_list">
<span class="sig-name descname"><span class="pre">dc_list</span></span><a class="headerlink" href="#src.RSF.RSF.dc_list" title="Link to this definition"></a></dt>
<dd><p>Array of Dc values for parameter sweep</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.RSF.RSF.num_features">
<span class="sig-name descname"><span class="pre">num_features</span></span><a class="headerlink" href="#src.RSF.RSF.num_features" title="Link to this definition"></a></dt>
<dd><p>Number of features for model reduction (if enabled)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.RSF.RSF.plotfigs">
<span class="sig-name descname"><span class="pre">plotfigs</span></span><a class="headerlink" href="#src.RSF.RSF.plotfigs" title="Link to this definition"></a></dt>
<dd><p>Whether to generate visualization plots</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.RSF.RSF.qstart">
<span class="sig-name descname"><span class="pre">qstart</span></span><a class="headerlink" href="#src.RSF.RSF.qstart" title="Link to this definition"></a></dt>
<dd><p>Initial parameter value for MCMC chains</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.RSF.RSF.qpriors">
<span class="sig-name descname"><span class="pre">qpriors</span></span><a class="headerlink" href="#src.RSF.RSF.qpriors" title="Link to this definition"></a></dt>
<dd><p>Prior distribution specification [type, lower, upper]</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.RSF.RSF.reduction">
<span class="sig-name descname"><span class="pre">reduction</span></span><a class="headerlink" href="#src.RSF.RSF.reduction" title="Link to this definition"></a></dt>
<dd><p>Whether to use model reduction techniques</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.RSF.RSF.model">
<span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#src.RSF.RSF.model" title="Link to this definition"></a></dt>
<dd><p>Forward model object (set externally)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.RSF.RSF.data">
<span class="sig-name descname"><span class="pre">data</span></span><a class="headerlink" href="#src.RSF.RSF.data" title="Link to this definition"></a></dt>
<dd><p>Generated or loaded time series data</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.RSF.RSF.format">
<span class="sig-name descname"><span class="pre">format</span></span><a class="headerlink" href="#src.RSF.RSF.format" title="Link to this definition"></a></dt>
<dd><p>Data storage format (‘json’ or ‘mysql’)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Basic usage for single parameter estimation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rsf</span> <span class="o">=</span> <span class="n">RSF</span><span class="p">(</span><span class="n">number_slip_values</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">lowest_slip_value</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">largest_slip_value</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">qstart</span><span class="o">=</span><span class="mf">0.015</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">qpriors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Uniform&quot;</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set up model and generate data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rsf</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">RateStateModel</span><span class="p">(</span><span class="n">number_time_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rsf</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s1">&#39;json&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rsf</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">rsf</span><span class="o">.</span><span class="n">generate_time_series</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Perform Bayesian inference</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">execution_time</span> <span class="o">=</span> <span class="n">rsf</span><span class="o">.</span><span class="n">inference</span><span class="p">(</span><span class="n">nsamples</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Analysis completed in </span><span class="si">{</span><span class="n">execution_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Multi-parameter sensitivity study</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rsf_multi</span> <span class="o">=</span> <span class="n">RSF</span><span class="p">(</span><span class="n">number_slip_values</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">lowest_slip_value</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">largest_slip_value</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">plotfigs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ... run analysis across parameter range</span>
</pre></div>
</div>
<dl>
<dt>Mathematical Background:</dt><dd><p>The class performs Bayesian inference on the rate and state friction model:</p>
<p>Likelihood: p(data|Dc) ∝ exp(-SSE/(2σ²))
Prior: p(Dc) ~ Uniform(lower, upper) or other specified distribution
Posterior: p(Dc|data) ∝ p(data|Dc) * p(Dc)</p>
<p>Where SSE is the sum of squared errors between model predictions and observations.</p>
</dd>
<dt>Performance Notes:</dt><dd><ul class="simple">
<li><p>Computation time scales with num_dc * nsamples * model_complexity</p></li>
<li><p>Memory usage scales with num_dc * num_tsteps for data storage</p></li>
<li><p>MCMC convergence depends on parameter ranges and data quality</p></li>
<li><p>Consider model reduction for very large parameter spaces</p></li>
</ul>
</dd>
<dt>Dependencies:</dt><dd><ul class="simple">
<li><p>MCMC class for Bayesian inference</p></li>
<li><p>RateStateModel class for forward modeling</p></li>
<li><p>JSON/MySQL save/load utilities</p></li>
<li><p>Matplotlib for visualization</p></li>
<li><p>NumPy/SciPy for numerical computations</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="src.RSF.RSF.generate_time_series">
<span class="sig-name descname"><span class="pre">generate_time_series</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/RSF.html#RSF.generate_time_series"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.RSF.RSF.generate_time_series" title="Link to this definition"></a></dt>
<dd><p>Generate synthetic time series data for all characteristic slip distances.</p>
<p>This method performs forward modeling across the entire parameter space
defined by dc_list, generating synthetic acceleration time series with
realistic noise for each Dc value. The data is concatenated into a single
array suitable for subsequent Bayesian analysis.</p>
<p>The method iterates through each Dc value, evaluates the rate and state
friction model, optionally generates plots for visualization, and
concatenates the noisy acceleration data into a comprehensive dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Concatenated noisy acceleration data with shape</dt><dd><p>(num_dc * num_tsteps,). Each segment of length num_tsteps
corresponds to one Dc value in dc_list. The data includes
synthetic noise to simulate experimental conditions.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>Process:</dt><dd><ol class="arabic simple">
<li><p>Calculate total array size for all Dc values</p></li>
<li><p>Initialize output array with zeros</p></li>
<li><p>For each Dc value:
- Set model parameter (model.Dc)
- Evaluate forward model to get time series
- Generate optional visualization plots
- Extract noisy acceleration data
- Store in appropriate array segment</p></li>
<li><p>Return concatenated data array</p></li>
</ol>
</dd>
<dt>Data Structure:</dt><dd><p>The returned array has segments arranged as:
[dc_1_data, dc_2_data, …, dc_n_data]
where each dc_i_data has length model.num_tsteps</p>
</dd>
<dt>Model Requirements:</dt><dd><ul class="simple">
<li><p>self.model must be set before calling this method</p></li>
<li><p>model must have Dc attribute that can be modified</p></li>
<li><p>model.evaluate() must return (time, acceleration, noisy_acceleration)</p></li>
<li><p>model.num_tsteps must be defined for array sizing</p></li>
</ul>
</dd>
<dt>Visualization:</dt><dd><p>If self.plotfigs is True, generates individual time series plots
for each Dc value showing acceleration vs. time with appropriate
titles and labels.</p>
</dd>
<dt>Error Handling:</dt><dd><ul class="simple">
<li><p>If model is not set, will raise AttributeError</p></li>
<li><p>If model.evaluate() fails, exception will propagate</p></li>
<li><p>Array indexing is safe due to pre-calculated dimensions</p></li>
</ul>
</dd>
<dt>Performance:</dt><dd><ul class="simple">
<li><p>Time complexity: O(num_dc * model_evaluation_time)</p></li>
<li><p>Space complexity: O(num_dc * num_tsteps)</p></li>
<li><p>Memory allocation done once upfront for efficiency</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Setup model and RSF driver</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">src.RateStateModel</span> <span class="kn">import</span> <span class="n">RateStateModel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">RateStateModel</span><span class="p">(</span><span class="n">number_time_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">end_time</span><span class="o">=</span><span class="mf">50.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rsf</span> <span class="o">=</span> <span class="n">RSF</span><span class="p">(</span><span class="n">number_slip_values</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">lowest_slip_value</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">largest_slip_value</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">plotfigs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rsf</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Generate synthetic data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">rsf</span><span class="o">.</span><span class="n">generate_time_series</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generated data shape: </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected shape: </span><span class="si">{</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rsf</span><span class="o">.</span><span class="n">dc_list</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">model</span><span class="o">.</span><span class="n">num_tsteps</span><span class="p">,)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Analyze data segments</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segment_length</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">num_tsteps</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">dc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rsf</span><span class="o">.</span><span class="n">dc_list</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">start_idx</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">segment_length</span>
<span class="gp">... </span>    <span class="n">end_idx</span> <span class="o">=</span> <span class="n">start_idx</span> <span class="o">+</span> <span class="n">segment_length</span>
<span class="gp">... </span>    <span class="n">segment_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:</span><span class="n">end_idx</span><span class="p">]</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dc=</span><span class="si">{</span><span class="n">dc</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">: RMS acceleration = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">segment_data</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl>
<dt>Usage in Analysis Pipeline:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Complete workflow</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rsf</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s1">&#39;json&#39;</span>  <span class="c1"># Set storage format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">synthetic_data</span> <span class="o">=</span> <span class="n">rsf</span><span class="o">.</span><span class="n">generate_time_series</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rsf</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">rsf</span><span class="o">.</span><span class="n">prepare_data</span><span class="p">(</span><span class="n">synthetic_data</span><span class="p">)</span>  <span class="c1"># Store/load data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">execution_time</span> <span class="o">=</span> <span class="n">rsf</span><span class="o">.</span><span class="n">inference</span><span class="p">(</span><span class="n">nsamples</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>  <span class="c1"># Run MCMC</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Each model evaluation generates independent noise realizations</p></li>
<li><p>The same random seed will produce identical results</p></li>
<li><p>Consider setting numpy random seed for reproducibility</p></li>
<li><p>Large parameter spaces may require significant computation time</p></li>
<li><p>Generated data represents “ground truth” with known parameters</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.RSF.RSF.inference">
<span class="sig-name descname"><span class="pre">inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/RSF.html#RSF.inference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.RSF.RSF.inference" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.RSF.RSF.perform_sampling_and_plotting">
<span class="sig-name descname"><span class="pre">perform_sampling_and_plotting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_lstm</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/RSF.html#RSF.perform_sampling_and_plotting"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.RSF.RSF.perform_sampling_and_plotting" title="Link to this definition"></a></dt>
<dd><p>Execute MCMC parameter estimation and generate posterior visualizations.</p>
<p>This method performs the core Bayesian inference workflow for a specific
characteristic slip distance (Dc) value. It extracts the relevant data
segment, initializes the MCMC sampler, runs the sampling algorithm,
and generates comprehensive posterior distribution plots.</p>
<p>The method handles data segmentation to isolate the time series corresponding
to the specified Dc value, configures the MCMC algorithm with appropriate
priors and starting values, and produces both sampling diagnostics and
final posterior visualizations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.ndarray</em>) – Complete concatenated time series data from all Dc values
with shape (num_dc * num_tsteps,). Contains noisy acceleration
measurements for the entire parameter space.</p></li>
<li><p><strong>dc</strong> (<em>float</em>) – Specific characteristic slip distance value to analyze.
Must be present in self.dc_list for proper data extraction.
Units should be consistent with model setup (typically μm).</p></li>
<li><p><strong>nsamples</strong> (<em>int</em>) – Number of MCMC samples to generate for this Dc value.
Should be sufficient for convergence (typically 1000-10000).
Includes burn-in period (automatically handled by MCMC class).</p></li>
<li><p><strong>model_lstm</strong> (<em>dict</em><em> or </em><em>None</em>) – LSTM model configuration for reduced-order modeling.
If None, uses full forward model evaluation.
If provided, should contain LSTM model parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Performs analysis and generates plots but does not return values.</dt><dd><p>Results are visualized through plot_dist() method.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<dl>
<dt>Process Workflow:</dt><dd><ol class="arabic simple">
<li><p>Locate Dc value in parameter list and extract corresponding data segment</p></li>
<li><p>Print diagnostic information about current analysis</p></li>
<li><p>Initialize MCMC object with model, data, and inference settings</p></li>
<li><p>Execute MCMC sampling with optional animation</p></li>
<li><p>Generate posterior distribution plots for visualization</p></li>
</ol>
</dd>
<dt>Data Segmentation:</dt><dd><p>The method extracts the relevant time series segment using:
- start_index = dc_index * model.num_tsteps
- end_index = start_index + model.num_tsteps</p>
<p>This assumes data is organized as concatenated segments from generate_time_series().</p>
</dd>
<dt>MCMC Configuration:</dt><dd><p>The MCMC sampler is initialized with:
- Forward model: self.model
- Observed data: noisy_data (extracted segment)
- True parameter: dc (for validation/comparison)
- Prior specification: self.qpriors
- Initial value: self.qstart
- LSTM model: model_lstm (optional)
- Sample count: nsamples</p>
</dd>
<dt>Error Handling:</dt><dd><ul class="simple">
<li><p>Checks if Dc value exists in dc_list</p></li>
<li><p>Prints error message and returns early if not found</p></li>
<li><p>MCMC sampling errors propagate to caller</p></li>
<li><p>Plotting errors are handled by plot_dist() method</p></li>
</ul>
</dd>
<dt>Output and Visualization:</dt><dd><ul class="simple">
<li><p>Prints analysis status and current Dc value</p></li>
<li><p>Generates MCMC animation if enabled in sampling</p></li>
<li><p>Creates posterior distribution plots via plot_dist()</p></li>
<li><p>No return value; results communicated through plots</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Setup for analysis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rsf</span> <span class="o">=</span> <span class="n">RSF</span><span class="p">(</span><span class="n">number_slip_values</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">plotfigs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rsf</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">RateStateModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rsf</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s1">&#39;json&#39;</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Generate and prepare data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">synthetic_data</span> <span class="o">=</span> <span class="n">rsf</span><span class="o">.</span><span class="n">generate_time_series</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prepared_data</span> <span class="o">=</span> <span class="n">rsf</span><span class="o">.</span><span class="n">prepare_data</span><span class="p">(</span><span class="n">synthetic_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Analyze specific Dc value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_dc</span> <span class="o">=</span> <span class="n">rsf</span><span class="o">.</span><span class="n">dc_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Second Dc value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rsf</span><span class="o">.</span><span class="n">perform_sampling_and_plotting</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">data</span><span class="o">=</span><span class="n">prepared_data</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">dc</span><span class="o">=</span><span class="n">target_dc</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">nsamples</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">model_lstm</span><span class="o">=</span><span class="kc">None</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Displays: &quot;--- Dc is {target_dc} ---&quot; and generates plots</span>
</pre></div>
</div>
<dl class="simple">
<dt>Performance Considerations:</dt><dd><ul class="simple">
<li><p>Execution time dominated by MCMC sampling (O(nsamples))</p></li>
<li><p>Data extraction is O(1) with pre-computed indices</p></li>
<li><p>Memory usage scales with nsamples for sample storage</p></li>
<li><p>Animation generation adds overhead if enabled</p></li>
</ul>
</dd>
<dt>Integration with Main Analysis:</dt><dd><p>This method is typically called from inference() in a loop over
all Dc values in dc_list, enabling systematic parameter space
exploration and comparison of posterior distributions.</p>
</dd>
<dt>Diagnostic Information:</dt><dd><p>Printed output includes:
- Current Dc value being analyzed
- MCMC progress indicators (from MCMC class)
- Convergence diagnostics (acceptance rates, etc.)</p>
</dd>
<dt>LSTM Model Support:</dt><dd><p>If model_lstm is provided:
- Uses reduced-order model evaluation for efficiency
- Maintains same inference framework
- Can significantly reduce computation time for complex models
- Model reduction parameters passed through to MCMC</p>
</dd>
<dt>Validation and Quality Control:</dt><dd><ul class="simple">
<li><p>Checks for valid Dc value in parameter list</p></li>
<li><p>MCMC class handles convergence diagnostics internally</p></li>
<li><p>Posterior plots provide visual validation of results</p></li>
<li><p>Consider adding quantitative convergence tests</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Requires self.model to be properly configured</p></li>
<li><p>Data indexing assumes consistent segment lengths</p></li>
<li><p>MCMC animation setting affects visualization</p></li>
<li><p>Results quality depends on nsamples and prior specification</p></li>
<li><p>Consider parallel execution for multiple Dc values</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.RSF.RSF.plot_dist">
<span class="sig-name descname"><span class="pre">plot_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/RSF.html#RSF.plot_dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.RSF.RSF.plot_dist" title="Link to this definition"></a></dt>
<dd><p>Generate comprehensive visualization of MCMC posterior distribution.</p>
<p>This method creates a dual-panel plot showing both the MCMC sample trace
and the corresponding probability density estimate. The visualization is
essential for assessing convergence, understanding posterior structure,
and presenting Bayesian inference results.</p>
<p>The plot combines a trace plot (left panel) showing the evolution of
parameter samples over iterations with a kernel density estimate (right panel)
showing the posterior probability distribution. This dual view provides
both convergence diagnostics and distributional information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qparams</strong> (<em>np.ndarray</em>) – MCMC parameter samples with shape (n_params, n_samples).
For this implementation, expects shape (1, n_samples)
where the single parameter is the Dc value.
Samples should be post-burn-in values.</p></li>
<li><p><strong>dc</strong> (<em>float</em>) – True characteristic slip distance value used for comparison
and plot labeling. Displayed in the plot title for reference
and validation purposes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Creates and displays a matplotlib figure with two subplots.</dt><dd><p>The figure is not returned or saved automatically.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<dl>
<dt>Plot Layout:</dt><dd><p>Left Panel (70% width):
- Trace plot showing parameter evolution vs. sample number
- Blue line with specified line width
- Y-axis: Parameter value (Dc)
- X-axis: Sample number (iteration)
- Shows mixing and convergence behavior</p>
<p>Right Panel (15% width):
- Kernel density estimate of posterior distribution
- Filled area under curve with transparency
- Y-axis: Parameter value (shared with left panel)
- X-axis: Probability density
- No tick marks for cleaner appearance</p>
</dd>
<dt>Styling Parameters:</dt><dd><ul class="simple">
<li><p>KDE_POINTS = 1000: Resolution of density estimate</p></li>
<li><p>PLOT_WIDTH_RATIO = [0.7, 0.15]: Panel width proportions</p></li>
<li><p>PLOT_SPACING = 0.15: Spacing between panels</p></li>
<li><p>PLOT_LINE_WIDTH = 1.0: Line thickness</p></li>
<li><p>PLOT_ALPHA = 0.3: Fill transparency</p></li>
</ul>
</dd>
<dt>Statistical Analysis:</dt><dd><p>The kernel density estimation uses Gaussian kernels with automatic
bandwidth selection via Scott’s rule. The density is evaluated over
the range defined by the trace plot’s y-axis limits.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># After MCMC sampling</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mcmc_obj</span> <span class="o">=</span> <span class="n">MCMC</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">dc_true</span><span class="p">,</span> <span class="n">qpriors</span><span class="p">,</span> <span class="n">qstart</span><span class="p">,</span> <span class="n">nsamples</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">posterior_samples</span> <span class="o">=</span> <span class="n">mcmc_obj</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Generate distribution plot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rsf</span> <span class="o">=</span> <span class="n">RSF</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rsf</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s1">&#39;json&#39;</span>  <span class="c1"># Required for title formatting</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rsf</span><span class="o">.</span><span class="n">plot_dist</span><span class="p">(</span><span class="n">posterior_samples</span><span class="p">,</span> <span class="n">dc_true</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<dl>
<dt>Interpretation Guide:</dt><dd><p>Trace Plot (Left):
- Horizontal lines suggest good mixing
- Trends indicate lack of convergence
- Oscillations show exploration of parameter space
- Stable variance suggests adequate burn-in</p>
<p>Density Plot (Right):
- Peak location: Posterior mode (most likely value)
- Width: Posterior uncertainty
- Shape: Distribution characteristics (skewness, multimodality)
- Area under curve: Should integrate to 1.0</p>
</dd>
<dt>Convergence Diagnostics:</dt><dd><p>Visual signs of good convergence:
- Trace plot shows random fluctuation around mean
- No obvious trends or drift in trace
- Density plot shows smooth, well-defined peak
- Multiple modes may indicate complex posterior structure</p>
</dd>
<dt>Title Information:</dt><dd><p>The plot title shows:
- True Dc value for comparison with posterior
- Data storage format used in analysis
- Mathematical notation using LaTeX formatting</p>
</dd>
<dt>Performance Notes:</dt><dd><ul class="simple">
<li><p>KDE computation scales as O(n*m) where n=samples, m=grid points</p></li>
<li><p>Memory usage minimal for typical sample sizes (&lt; 10^6 samples)</p></li>
<li><p>Plot rendering time depends on sample size and grid resolution</p></li>
</ul>
</dd>
<dt>Customization Options:</dt><dd><p>Common modifications:
- Adjust KDE_POINTS for smoother/faster density estimates
- Change width ratios for different emphasis
- Add reference lines for true parameter values
- Overlay multiple chains for comparison
- Add summary statistics annotations</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Assumes single parameter (Dc) analysis</p></li>
<li><p>Uses first row of qparams array (qparams[0, :])</p></li>
<li><p>Figure is created but not saved automatically</p></li>
<li><p>Consider plt.savefig() for permanent storage</p></li>
<li><p>Panel spacing and sizing optimized for typical screen viewing</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.RSF.RSF.plot_time_series">
<span class="sig-name descname"><span class="pre">plot_time_series</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acceleration</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/RSF.html#RSF.plot_time_series"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.RSF.RSF.plot_time_series" title="Link to this definition"></a></dt>
<dd><p>Generate time series visualization plots for rate and state friction data.</p>
<p>This method creates publication-quality plots of acceleration time series
with proper formatting, labels, and styling. The plots help visualize
the temporal evolution of the rate and state friction system and are
essential for understanding model behavior and validating results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> (<em>np.ndarray</em>) – Time array with shape (num_tsteps,) containing
time values from model evaluation. Units should
be consistent with model setup (typically seconds).</p></li>
<li><p><strong>acceleration</strong> (<em>np.ndarray</em>) – Acceleration array with shape (num_tsteps,)
containing the clean (non-noisy) acceleration
time series from the rate and state model.
Units typically in μm/s².</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Creates and displays matplotlib figure but does not return it.</dt><dd><p>The figure is not saved automatically.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<dl class="simple">
<dt>Plot Features:</dt><dd><ul class="simple">
<li><p>Professional formatting with LaTeX-style mathematical notation</p></li>
<li><p>Grid lines for easier data reading</p></li>
<li><p>Proper axis labels with units</p></li>
<li><p>Title showing current Dc parameter value</p></li>
<li><p>Legend indicating this is the “True” (non-noisy) signal</p></li>
<li><p>Time axis limits set to model bounds with small buffer</p></li>
</ul>
</dd>
<dt>Styling:</dt><dd><ul class="simple">
<li><p>Line width: 1.0 for clear visibility</p></li>
<li><p>Grid: Enabled for professional appearance</p></li>
<li><p>Title: Shows Dc value in scientific notation</p></li>
<li><p>Labels: Use proper mathematical formatting with LaTeX</p></li>
</ul>
</dd>
<dt>Conditional Execution:</dt><dd><p>The method only generates plots if self.plotfigs is True, allowing
for batch processing without visual output when desired.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Single plot generation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rsf</span> <span class="o">=</span> <span class="n">RSF</span><span class="p">(</span><span class="n">plotfigs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rsf</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">RateStateModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rsf</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">Dc</span> <span class="o">=</span> <span class="mf">0.02</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">,</span> <span class="n">acc</span><span class="p">,</span> <span class="n">acc_noise</span> <span class="o">=</span> <span class="n">rsf</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rsf</span><span class="o">.</span><span class="n">plot_time_series</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">acc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># Display the plot</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Batch plotting (automatically called in generate_time_series)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rsf</span> <span class="o">=</span> <span class="n">RSF</span><span class="p">(</span><span class="n">number_slip_values</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">plotfigs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ... setup model ...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">rsf</span><span class="o">.</span><span class="n">generate_time_series</span><span class="p">()</span>  <span class="c1"># Creates 5 plots automatically</span>
</pre></div>
</div>
<dl class="simple">
<dt>Mathematical Notation:</dt><dd><ul class="simple">
<li><p>Uses LaTeX formatting for proper mathematical symbols</p></li>
<li><p>Dc parameter shown in micrometers (μm)</p></li>
<li><p>Acceleration units shown as μm/s²</p></li>
<li><p>Subscripts and Greek letters properly formatted</p></li>
</ul>
</dd>
<dt>Performance Considerations:</dt><dd><ul class="simple">
<li><p>Each plot creation takes ~0.1-0.5 seconds depending on data size</p></li>
<li><p>Memory usage minimal for typical time series lengths</p></li>
<li><p>No automatic saving; manually save if needed</p></li>
<li><p>Consider plt.close() for batch processing to manage memory</p></li>
</ul>
</dd>
<dt>Integration with Analysis:</dt><dd><p>The plots are particularly useful for:
- Visual validation of model behavior
- Identifying stick-slip events and patterns
- Comparing different Dc parameter effects
- Quality control of synthetic data generation
- Presentation and publication figures</p>
</dd>
<dt>Customization:</dt><dd><p>To modify plot appearance, extend this method or create custom
plotting functions. Common modifications include:
- Different line styles or colors
- Logarithmic scales for specific analyses
- Subplots for multiple variables
- Animation for temporal evolution
- Statistical overlays (mean, confidence intervals)</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Plots are created in separate figure windows</p></li>
<li><p>No automatic figure management (closing, saving)</p></li>
<li><p>Uses current matplotlib backend settings</p></li>
<li><p>Figure size uses matplotlib defaults</p></li>
<li><p>Consider plot density for large parameter sweeps</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.RSF.RSF.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/RSF.html#RSF.prepare_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.RSF.RSF.prepare_data" title="Link to this definition"></a></dt>
<dd><p>Prepare and persist data using specified storage format (JSON or MySQL).</p>
<p>This method provides data persistence abstraction, allowing seamless
switching between JSON file storage and MySQL database storage for
time series data. It handles the complete save/load cycle to ensure
data integrity and format consistency across different storage backends.</p>
<p>The method performs a round-trip operation (save then load) to verify
data integrity and ensure the returned data matches the stored format
exactly. This is particularly important for numerical precision and
array structure preservation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>np.ndarray</em>) – Time series data to be stored and retrieved.
Typically the output from generate_time_series()
with shape (num_dc * num_tsteps,). Should contain
numerical values (floats) representing acceleration
measurements with synthetic noise.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>The same data after save/load round-trip, potentially</dt><dd><p>with format-specific transformations applied (e.g.,
precision changes, type conversions). Shape and values
should match input data within numerical precision limits.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<dl>
<dt>Storage Formats:</dt><dd><p>JSON Format (self.format == ‘json’):
- Saves to ‘data.json’ in current directory
- Uses custom JSON encoder for NumPy array handling
- Preserves array structure and numerical precision
- Human-readable format, suitable for small to medium datasets
- Platform-independent, version control friendly</p>
<p>MySQL Format (self.format == ‘mysql’):
- Saves to MySQL database with predefined connection parameters
- Uses chunked insertion for memory efficiency
- Suitable for large datasets and concurrent access
- Requires MySQL server setup and proper credentials
- Supports database operations and queries</p>
</dd>
<dt>Prerequisites:</dt><dd><ul class="simple">
<li><p>self.format must be set to either ‘json’ or ‘mysql’</p></li>
<li><p>For MySQL: database server must be running and accessible</p></li>
<li><p>For MySQL: connection parameters must be valid</p></li>
<li><p>Required save/load modules must be imported</p></li>
</ul>
</dd>
<dt>File Management:</dt><dd><p>JSON files are created in the current working directory:
- ‘data.json’: Contains the time series data
- ‘model_lstm.json’: Placeholder for LSTM model data (future use)</p>
</dd>
<dt>Database Configuration:</dt><dd><p>MySQL connection uses hardcoded parameters:
- Host: ‘localhost’
- User: ‘my_user’
- Password: ‘my_password’
- Database: ‘my_database’</p>
<p>Note: Consider moving to configuration file or environment variables</p>
</dd>
<dt>Error Handling:</dt><dd><ul class="simple">
<li><p>File permission errors for JSON format</p></li>
<li><p>Database connection errors for MySQL format</p></li>
<li><p>Invalid data format or type errors</p></li>
<li><p>Network connectivity issues for remote databases</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># JSON storage workflow</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rsf</span> <span class="o">=</span> <span class="n">RSF</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rsf</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s1">&#39;json&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">original_data</span> <span class="o">=</span> <span class="n">rsf</span><span class="o">.</span><span class="n">generate_time_series</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stored_data</span> <span class="o">=</span> <span class="n">rsf</span><span class="o">.</span><span class="n">prepare_data</span><span class="p">(</span><span class="n">original_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">original_data</span><span class="p">,</span> <span class="n">stored_data</span><span class="p">)</span>  <span class="c1"># Should be True</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># MySQL storage workflow</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rsf</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s1">&#39;mysql&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Ensure MySQL server is running with correct credentials</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stored_data</span> <span class="o">=</span> <span class="n">rsf</span><span class="o">.</span><span class="n">prepare_data</span><span class="p">(</span><span class="n">original_data</span><span class="p">)</span>
</pre></div>
</div>
<dl>
<dt>Performance Considerations:</dt><dd><p>JSON Format:
- Fast for small to medium datasets (&lt; 100MB)
- Memory usage during save: ~2x data size
- Disk space: ~1.5x memory size (text format overhead)</p>
<p>MySQL Format:
- Scales well for large datasets
- Network latency affects performance
- Chunked insertion optimizes memory usage
- Database indexing can improve query performance</p>
</dd>
<dt>Data Integrity:</dt><dd><ul class="simple">
<li><p>Round-trip verification ensures data consistency</p></li>
<li><p>Numerical precision preserved within format limits</p></li>
<li><p>Array structure and ordering maintained</p></li>
<li><p>Consider checksums for critical applications</p></li>
</ul>
</dd>
<dt>Security Notes:</dt><dd><ul class="simple">
<li><p>JSON files stored in plaintext (consider encryption for sensitive data)</p></li>
<li><p>MySQL credentials hardcoded (security risk in production)</p></li>
<li><p>File permissions should be set appropriately</p></li>
<li><p>Database access should use principle of least privilege</p></li>
</ul>
</dd>
<dt>Future Enhancements:</dt><dd><ul class="simple">
<li><p>Configuration file for database parameters</p></li>
<li><p>Additional storage formats (HDF5, Parquet)</p></li>
<li><p>Compression options for large datasets</p></li>
<li><p>Metadata storage (timestamps, model parameters)</p></li>
<li><p>Data validation and checksum verification</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.RSF.measure_execution_time">
<span class="sig-prename descclassname"><span class="pre">src.RSF.</span></span><span class="sig-name descname"><span class="pre">measure_execution_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/RSF.html#measure_execution_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.RSF.measure_execution_time" title="Link to this definition"></a></dt>
<dd><p>Decorator to measure and return the execution time of a function.</p>
<p>This decorator wraps a function to automatically measure its execution time
using high-precision timing. It’s particularly useful for performance analysis
and benchmarking of computational methods like MCMC sampling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<em>callable</em>) – The function to be timed. Can be any callable object
including methods, lambda functions, or regular functions.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A wrapper function that returns the execution time in seconds</dt><dd><p>instead of the original function’s return value.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>callable</p>
</dd>
</dl>
<dl class="simple">
<dt>Usage:</dt><dd><p>The decorator is applied using the &#64; syntax above function definitions.
When the decorated function is called, it returns execution time rather
than the original return value.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@measure_execution_time</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">slow_computation</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="s2">&quot;done&quot;</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exec_time</span> <span class="o">=</span> <span class="n">slow_computation</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Function took </span><span class="si">{</span><span class="n">exec_time</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="go">Function took 2.001 seconds</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Uses time.time() for cross-platform compatibility</p></li>
<li><p>Returns execution time, not the original function’s return value</p></li>
<li><p>Suitable for timing functions that don’t need their return values</p></li>
<li><p>For functions where return values are needed, consider a different approach</p></li>
</ul>
</div>
<dl class="simple">
<dt>Performance Considerations:</dt><dd><ul class="simple">
<li><p>Minimal overhead (&lt; 1 microsecond typically)</p></li>
<li><p>Uses wall-clock time, not CPU time</p></li>
<li><p>Resolution depends on system clock (usually microsecond precision)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-src.RateStateModel">
<span id="src-ratestatemodel-module"></span><h2>src.RateStateModel module<a class="headerlink" href="#module-src.RateStateModel" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="src.RateStateModel.RateStateModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.RateStateModel.</span></span><span class="sig-name descname"><span class="pre">RateStateModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">number_time_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/RateStateModel.html#RateStateModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.RateStateModel.RateStateModel" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Rate and State Friction Model for earthquake fault mechanics simulation.</p>
<p>This class implements the rate and state friction law, a widely used constitutive
model in earthquake mechanics that describes the evolution of friction on fault
surfaces. The model captures the velocity dependence of friction and the time-
dependent healing of fault surfaces through a state variable.</p>
<p>The rate and state friction law is governed by:
μ = μ₀ + a*ln(V/V_ref) + b*ln(V_ref*θ/Dc)
dθ/dt = 1 - V*θ/Dc</p>
<p>Where:
- μ is the friction coefficient
- V is the sliding velocity
- θ is the state variable (characteristic healing time)
- a, b are material parameters
- Dc is the characteristic slip distance
- μ₀ is the reference friction coefficient</p>
<p>The model includes:
- Dynamic loading with time-varying velocity
- Spring-block system dynamics with effective stiffness
- Optional radiation damping for realistic energy dissipation
- Numerical integration using adaptive ODE solvers
- Synthetic noise addition to simulate experimental conditions</p>
<p>Physical Interpretation:
- a &gt; 0: velocity strengthening (direct effect)
- b &gt; 0: velocity weakening when combined with state evolution
- a-b &lt; 0: potentially unstable sliding (stick-slip behavior)
- a-b &gt; 0: stable sliding
- Dc controls the distance scale over which state evolves</p>
<p>Applications:
- Earthquake fault mechanics modeling
- Laboratory friction experiments simulation
- Seismic cycle studies
- Fault stability analysis
- Parameter estimation from experimental data</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="src.RateStateModel.RateStateModel.a">
<span class="sig-name descname"><span class="pre">a</span></span><a class="headerlink" href="#src.RateStateModel.RateStateModel.a" title="Link to this definition"></a></dt>
<dd><p>Direct effect parameter (velocity dependence)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.RateStateModel.RateStateModel.b">
<span class="sig-name descname"><span class="pre">b</span></span><a class="headerlink" href="#src.RateStateModel.RateStateModel.b" title="Link to this definition"></a></dt>
<dd><p>Evolution effect parameter (state dependence)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.RateStateModel.RateStateModel.mu_ref">
<span class="sig-name descname"><span class="pre">mu_ref</span></span><a class="headerlink" href="#src.RateStateModel.RateStateModel.mu_ref" title="Link to this definition"></a></dt>
<dd><p>Reference friction coefficient</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.RateStateModel.RateStateModel.V_ref">
<span class="sig-name descname"><span class="pre">V_ref</span></span><a class="headerlink" href="#src.RateStateModel.RateStateModel.V_ref" title="Link to this definition"></a></dt>
<dd><p>Reference sliding velocity</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.RateStateModel.RateStateModel.k1">
<span class="sig-name descname"><span class="pre">k1</span></span><a class="headerlink" href="#src.RateStateModel.RateStateModel.k1" title="Link to this definition"></a></dt>
<dd><p>Radiation damping coefficient</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.RateStateModel.RateStateModel.t_start">
<span class="sig-name descname"><span class="pre">t_start</span></span><a class="headerlink" href="#src.RateStateModel.RateStateModel.t_start" title="Link to this definition"></a></dt>
<dd><p>Simulation start time</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.RateStateModel.RateStateModel.t_final">
<span class="sig-name descname"><span class="pre">t_final</span></span><a class="headerlink" href="#src.RateStateModel.RateStateModel.t_final" title="Link to this definition"></a></dt>
<dd><p>Simulation end time</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.RateStateModel.RateStateModel.num_tsteps">
<span class="sig-name descname"><span class="pre">num_tsteps</span></span><a class="headerlink" href="#src.RateStateModel.RateStateModel.num_tsteps" title="Link to this definition"></a></dt>
<dd><p>Number of time steps for integration</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.RateStateModel.RateStateModel.delta_t">
<span class="sig-name descname"><span class="pre">delta_t</span></span><a class="headerlink" href="#src.RateStateModel.RateStateModel.delta_t" title="Link to this definition"></a></dt>
<dd><p>Time step size</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.RateStateModel.RateStateModel.mu_t_zero">
<span class="sig-name descname"><span class="pre">mu_t_zero</span></span><a class="headerlink" href="#src.RateStateModel.RateStateModel.mu_t_zero" title="Link to this definition"></a></dt>
<dd><p>Initial friction coefficient</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.RateStateModel.RateStateModel.RadiationDamping">
<span class="sig-name descname"><span class="pre">RadiationDamping</span></span><a class="headerlink" href="#src.RateStateModel.RateStateModel.RadiationDamping" title="Link to this definition"></a></dt>
<dd><p>Whether to include radiation damping</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.RateStateModel.RateStateModel.Dc">
<span class="sig-name descname"><span class="pre">Dc</span></span><a class="headerlink" href="#src.RateStateModel.RateStateModel.Dc" title="Link to this definition"></a></dt>
<dd><p>Characteristic slip distance (must be set before evaluation)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Basic usage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">RateStateModel</span><span class="p">(</span><span class="n">number_time_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">end_time</span><span class="o">=</span><span class="mf">100.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">Dc</span> <span class="o">=</span> <span class="mf">0.02</span>  <span class="c1"># Set characteristic distance</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">,</span> <span class="n">acc</span><span class="p">,</span> <span class="n">acc_noise</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Custom parameters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">RateStateModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mf">0.015</span>  <span class="c1"># Modify direct effect</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="mf">0.020</span>  <span class="c1"># Modify evolution effect</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">Dc</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">RadiationDamping</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Disable damping</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Analysis of results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">,</span> <span class="n">acceleration</span><span class="p">,</span> <span class="n">noisy_acceleration</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">acceleration</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Clean signal&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">noisy_acceleration</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;With noise&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Acceleration&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">References</p>
<ul class="simple">
<li><p>Dieterich, J. H. (1979). Modeling of rock friction</p></li>
<li><p>Ruina, A. (1983). Slip instability and state variable friction laws</p></li>
<li><p>Marone, C. (1998). Laboratory-derived friction laws and their application</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Dc parameter must be set before calling evaluate()</p></li>
<li><p>The model uses adaptive ODE integration for numerical stability</p></li>
<li><p>Radiation damping is enabled by default for physical realism</p></li>
<li><p>Time units are arbitrary but should be consistent throughout</p></li>
<li><p>Acceleration output includes synthetic noise for realism</p></li>
</ul>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="src.RateStateModel.RateStateModel.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/RateStateModel.html#RateStateModel.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.RateStateModel.RateStateModel.evaluate" title="Link to this definition"></a></dt>
<dd><p>Solve the rate and state friction model using numerical integration.</p>
<p>This method performs the complete simulation of the rate and state friction
system by solving the coupled differential equations numerically. The system
includes the friction evolution, state variable evolution, and dynamic loading
with optional radiation damping.</p>
<p>The method solves the system:
dμ/dt = k’<a href="#id1"><span class="problematic" id="id2">*</span></a>(V_l - V) - k1*dV/dt  (with radiation damping)
dθ/dt = 1 - V*θ/Dc
dV/dt = (V/a)*(dμ/dt - b/θ*dθ/dt)</p>
<p>Where:
- V is computed from the rate and state law: V = V_ref * exp((μ-μ₀-b*ln(V_ref*θ/Dc))/a)
- V_l is the loading velocity: V_ref * (1 + exp(-t/a1) * sin(a2*t))
- k’ is the effective stiffness: 1e-2 * 10 / Dc</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>A 3-element tuple containing:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>t (np.ndarray): Time array with shape (num_steps,). Time values</dt><dd><p>from t_start to t_final with delta_t spacing.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>acc (np.ndarray): Clean acceleration array with shape (num_steps,).</dt><dd><p>Computed as numerical derivative of velocity.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>acc_noise (np.ndarray): Noisy acceleration array with shape (num_steps,).</dt><dd><p>Clean acceleration plus 100% relative Gaussian noise.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ValueError</strong> – If Dc is None (characteristic distance must be set before evaluation)</p></li>
<li><p><strong>RuntimeError</strong> – If ODE integration fails or becomes unstable</p></li>
<li><p><strong>FloatingPointError</strong> – If numerical overflow/underflow occurs during integration</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Algorithm Details:</dt><dd><ol class="arabic simple">
<li><p>Sets up the differential equation system with nested friction function</p></li>
<li><p>Initializes arrays for state variables (μ, θ, V) and outputs</p></li>
<li><p>Uses Dormand-Prince 8(5,3) ODE solver with adaptive step size</p></li>
<li><p>Integrates over the specified time range with fixed output intervals</p></li>
<li><p>Computes acceleration via finite differences</p></li>
<li><p>Adds synthetic noise to acceleration for realism</p></li>
</ol>
</dd>
<dt>Physical Interpretation:</dt><dd><ul class="simple">
<li><p>Loading function creates time-varying driving velocity</p></li>
<li><p>Effective stiffness couples system dynamics to Dc parameter</p></li>
<li><p>Radiation damping models energy dissipation during rapid sliding</p></li>
<li><p>State variable evolution controls friction memory effects</p></li>
<li><p>Acceleration output represents measurable seismic signal</p></li>
</ul>
</dd>
<dt>Numerical Considerations:</dt><dd><ul class="simple">
<li><p>Uses high-precision ODE solver (rtol=1e-6, atol=1e-10)</p></li>
<li><p>Adaptive time stepping for numerical stability</p></li>
<li><p>Handles stiff systems through implicit methods</p></li>
<li><p>Acceleration computed via backward differences for stability</p></li>
</ul>
</dd>
<dt>Noise Model:</dt><dd><ul class="simple">
<li><p>Multiplicative Gaussian noise: acc_noise = acc + 1.0 * <a href="#id3"><span class="problematic" id="id4">|acc|</span></a> * N(0,1)</p></li>
<li><p>100% relative noise level (signal-dependent)</p></li>
<li><p>Models experimental measurement uncertainty</p></li>
<li><p>Preserves sign of acceleration signal</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">RateStateModel</span><span class="p">(</span><span class="n">number_time_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">Dc</span> <span class="o">=</span> <span class="mf">0.02</span>  <span class="c1"># Required: set characteristic distance</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Run simulation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="p">,</span> <span class="n">clean_acc</span><span class="p">,</span> <span class="n">noisy_acc</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Analyze results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Simulation duration: </span><span class="si">{</span><span class="n">time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Max acceleration: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">clean_acc</span><span class="p">))</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMS noise level: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">noisy_acc</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">clean_acc</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Check for stick-slip behavior</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">velocity_proxy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">clean_acc</span><span class="p">)</span>  <span class="c1"># Rough velocity estimate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">velocity_proxy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">velocity_proxy</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Stick-slip behavior detected&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="simple">
<dt>Performance Notes:</dt><dd><ul class="simple">
<li><p>Computation time scales linearly with number_time_steps</p></li>
<li><p>Memory usage is O(number_time_steps) for storing trajectories</p></li>
<li><p>ODE solver may slow down for stiff systems (small Dc, large a-b)</p></li>
<li><p>Consider reducing tolerance for faster computation if high precision not needed</p></li>
</ul>
</dd>
<dt>Validation:</dt><dd><ul class="simple">
<li><p>Check energy conservation (if radiation damping disabled)</p></li>
<li><p>Verify friction bounds: μ should remain physically reasonable</p></li>
<li><p>Monitor state variable: θ &gt; 0 always (physical constraint)</p></li>
<li><p>Compare with analytical solutions for simple loading cases</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-src.imports">
<span id="src-imports-module"></span><h2>src.imports module<a class="headerlink" href="#module-src.imports" title="Link to this heading"></a></h2>
</section>
<section id="module-src.json_save_load">
<span id="src-json-save-load-module"></span><h2>src.json_save_load module<a class="headerlink" href="#module-src.json_save_load" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="src.json_save_load.load_object">
<span class="sig-prename descclassname"><span class="pre">src.json_save_load.</span></span><span class="sig-name descname"><span class="pre">load_object</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/json_save_load.html#load_object"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.json_save_load.load_object" title="Link to this definition"></a></dt>
<dd><p>Loads a Python object from a JSON file with support for NumPy arrays.</p>
<p>This function deserializes JSON files back into Python objects, with special
handling for NumPy arrays that were encoded using the save_object function.
It can reconstruct complex nested structures containing NumPy arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – The path/filename of the JSON file to load.
Should be a file previously created with save_object().</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>The deserialized Python object with NumPy arrays properly</dt><dd><p>reconstructed. Returns None if an error occurs during loading.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object or None</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Exception</strong> – Any exception that occurs during file reading or JSON deserialization
    will be caught and printed. Common exceptions include:
    - FileNotFoundError: File does not exist
    - PermissionError: Insufficient read permissions
    - json.JSONDecodeError: Invalid JSON format
    - ValueError: Issues during NumPy array reconstruction</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load a simple object</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">load_object</span><span class="p">(</span><span class="s2">&quot;simple_data.json&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="go">{&#39;numbers&#39;: [1, 2, 3], &#39;name&#39;: &#39;test&#39;}</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load object with NumPy arrays</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">complex_data</span> <span class="o">=</span> <span class="n">load_object</span><span class="p">(</span><span class="s2">&quot;complex_data.json&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">complex_data</span><span class="p">[</span><span class="s2">&quot;matrix&quot;</span><span class="p">]))</span>
<span class="go">&lt;class &#39;numpy.ndarray&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">complex_data</span><span class="p">[</span><span class="s2">&quot;matrix&quot;</span><span class="p">])</span>
<span class="go">[[1 2]</span>
<span class="go"> [3 4]]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Returns None on error instead of raising exceptions</p></li>
<li><p>Error messages are printed to stdout</p></li>
<li><p>For production use, consider allowing exceptions to propagate or using logging</p></li>
<li><p>Loaded NumPy arrays will have the same dtype as when they were saved</p></li>
</ul>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.json_save_load.numpy_array_decoder">
<span class="sig-prename descclassname"><span class="pre">src.json_save_load.</span></span><span class="sig-name descname"><span class="pre">numpy_array_decoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dct</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/json_save_load.html#numpy_array_decoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.json_save_load.numpy_array_decoder" title="Link to this definition"></a></dt>
<dd><p>Custom JSON decoder function for reconstructing NumPy arrays.</p>
<p>This function is used as an object hook with json.load() to reconstruct
NumPy arrays that were encoded using numpy_array_encoder. It identifies
dictionaries that represent encoded NumPy arrays and converts them back
to their original NumPy array form.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dct</strong> (<em>dict</em>) – A dictionary from the JSON parsing process. If it contains
the special “__ndarray__” key, it will be converted back to
a NumPy array. Otherwise, it’s returned unchanged.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Returns a reconstructed NumPy array if the dictionary</dt><dd><p>contains encoded array data, otherwise returns the
original dictionary unchanged.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray or dict</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># This would typically be called internally by json.load()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoded_dict</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s2">&quot;__ndarray__&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]],</span>
<span class="gp">... </span>    <span class="s2">&quot;shape&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">numpy_array_decoder</span><span class="p">(</span><span class="n">encoded_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="go">[[1 2]</span>
<span class="go"> [3 4]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">arr</span><span class="p">))</span>
<span class="go">&lt;class &#39;numpy.ndarray&#39;&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is typically used internally by json.load() and not called directly.
It’s passed as the ‘object_hook’ parameter to json.load().</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.json_save_load.numpy_array_encoder">
<span class="sig-prename descclassname"><span class="pre">src.json_save_load.</span></span><span class="sig-name descname"><span class="pre">numpy_array_encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/json_save_load.html#numpy_array_encoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.json_save_load.numpy_array_encoder" title="Link to this definition"></a></dt>
<dd><p>Custom JSON encoder function for NumPy arrays.</p>
<p>This function is used as a custom encoder with json.dump() to handle NumPy arrays
which are not natively JSON serializable. It converts NumPy arrays into a
dictionary format that preserves both the data and shape information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obj</strong> – The object to be encoded. Expected to be a NumPy array when called
by the JSON encoder, but will raise TypeError for unsupported types.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl>
<dt>A dictionary containing the NumPy array data in the format:</dt><dd><dl class="simple">
<dt>{</dt><dd><p>“__ndarray__”: True,
“data”: list,  # The array data as a nested list
“shape”: tuple # The original shape of the array</p>
</dd>
</dl>
<p>}</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>TypeError</strong> – If the object is not a NumPy array or other JSON-serializable type.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoded</span> <span class="o">=</span> <span class="n">numpy_array_encoder</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">encoded</span><span class="p">)</span>
<span class="go">{&#39;__ndarray__&#39;: True, &#39;data&#39;: [[1, 2], [3, 4]], &#39;shape&#39;: (2, 2)}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is typically used internally by json.dump() and not called directly.
It’s passed as the ‘default’ parameter to json.dump().</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.json_save_load.save_object">
<span class="sig-prename descclassname"><span class="pre">src.json_save_load.</span></span><span class="sig-name descname"><span class="pre">save_object</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/json_save_load.html#save_object"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.json_save_load.save_object" title="Link to this definition"></a></dt>
<dd><p>Saves a Python object to a JSON file with support for NumPy arrays.</p>
<p>This function serializes Python objects to JSON format, with special handling
for NumPy arrays through the custom numpy_array_encoder. The resulting JSON
file can be loaded back using the corresponding load_object function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> – The Python object to save. Can contain nested structures with
lists, dictionaries, NumPy arrays, and other JSON-serializable types.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – The path/filename where the JSON file will be saved.
Should include the .json extension for clarity.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Exception</strong> – Any exception that occurs during file writing or JSON serialization
    will be caught and printed. Common exceptions include:
    - FileNotFoundError: Invalid file path
    - PermissionError: Insufficient write permissions
    - TypeError: Object contains non-serializable types not handled by encoder</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Save a simple object</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;numbers&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;test&quot;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">save_object</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;simple_data.json&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Save object with NumPy arrays</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">complex_data</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s2">&quot;matrix&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]),</span>
<span class="gp">... </span>    <span class="s2">&quot;vector&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="s2">&quot;2024&quot;</span><span class="p">}</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">save_object</span><span class="p">(</span><span class="n">complex_data</span><span class="p">,</span> <span class="s2">&quot;complex_data.json&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>The function will overwrite existing files without warning</p></li>
<li><p>Error messages are printed to stdout but exceptions are suppressed</p></li>
<li><p>For production use, consider allowing exceptions to propagate or using logging</p></li>
</ul>
</div>
</dd></dl>

</section>
<section id="module-src.main">
<span id="src-main-module"></span><h2>src.main module<a class="headerlink" href="#module-src.main" title="Link to this heading"></a></h2>
<p>Rate and State Friction Model Parameter Estimation using Bayesian Inference.</p>
<p>This script demonstrates a complete workflow for analyzing earthquake fault mechanics
using Rate and State Friction (RSF) models and Markov Chain Monte Carlo (MCMC)
parameter estimation. The analysis includes forward modeling, synthetic data
generation, and Bayesian inference of characteristic slip distance parameters.</p>
<p>The workflow encompasses:
1. Forward modeling of rate and state friction physics
2. Synthetic time series generation across parameter space
3. Data persistence using configurable storage backends
4. MCMC-based Bayesian parameter estimation
5. Posterior distribution analysis and visualization</p>
<p>This implementation serves as both a research tool for earthquake mechanics
studies and a demonstration of advanced Bayesian computational methods for
inverse problems in geophysics.</p>
<p>Key Features:
- Multi-parameter sensitivity analysis across Dc values
- Configurable data storage (JSON/MySQL backends)
- Comprehensive visualization and diagnostics
- Performance monitoring and optimization
- Modular design for easy extension and modification</p>
<p>Scientific Applications:
- Earthquake fault parameter estimation from seismic data
- Laboratory friction experiment analysis and interpretation
- Model validation and uncertainty quantification studies
- Computational method development and benchmarking</p>
<p>Dependencies:
- NumPy/SciPy for numerical computations
- Matplotlib for visualization
- Custom modules: RSF, RateStateModel, MCMC
- Optional: MySQL connector for database storage</p>
<dl class="simple">
<dt>Example Usage:</dt><dd><p>python main.py</p>
</dd>
</dl>
<p>Author: [Your Name]
Date: [Current Date]
Version: 1.0</p>
<dl class="py function">
<dt class="sig sig-object py" id="src.main.main">
<span class="sig-prename descclassname"><span class="pre">src.main.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/main.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.main.main" title="Link to this definition"></a></dt>
<dd><p>Main execution function for Rate and State Friction parameter estimation.</p>
<p>This function orchestrates the complete workflow for Bayesian analysis of
earthquake fault mechanics using Rate and State Friction models. It provides
a comprehensive demonstration of advanced computational methods for parameter
estimation in geophysical inverse problems.</p>
<p>The function executes the full analysis pipeline:
1. Problem initialization and forward model setup
2. Synthetic data generation with realistic noise
3. Bayesian inference using adaptive MCMC methods
4. Results visualization and performance assessment</p>
<dl>
<dt>Workflow Overview:</dt><dd><p>The main function demonstrates a typical research workflow for earthquake
fault parameter estimation:</p>
<p>Setup Phase:
- Initialize RSF analysis framework with parameter space
- Configure Rate and State friction forward model
- Generate synthetic time series data across Dc values</p>
<p>Analysis Phase:
- Perform Bayesian inference using JSON data storage
- Execute MCMC sampling for each characteristic slip distance
- Generate posterior distributions and convergence diagnostics</p>
<p>Visualization Phase:
- Display all generated plots and analysis results
- Clean up figure resources for memory management</p>
</dd>
<dt>Configuration:</dt><dd><p>The analysis uses module-level constants for easy customization:
- Parameter space: 5 Dc values from 100-5000 μm
- Temporal resolution: 500 time steps over 50 seconds
- MCMC sampling: 500 samples per Dc value
- Data storage: JSON format for demonstration
- Prior distribution: Uniform [0, 10000] μm</p>
</dd>
<dt>Performance Monitoring:</dt><dd><p>The function tracks computational performance:
- JSON inference execution time measurement
- Memory usage through visualization management
- Computational efficiency assessment</p>
</dd>
<dt>Output and Visualization:</dt><dd><p>Generated results include:
- Time series plots for each Dc value (if plotting enabled)
- MCMC trace plots showing parameter evolution
- Posterior probability density plots
- Convergence diagnostics and acceptance statistics
- Performance metrics and timing information</p>
</dd>
<dt>Example Execution:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Run complete analysis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">python</span> <span class="n">main</span><span class="o">.</span><span class="n">py</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Expected output:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># --- Dc is 100.0 ---</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># [MCMC progress indicators]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># --- Dc is 1350.0 ---</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># [MCMC progress indicators]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ... (for all Dc values)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># [Posterior distribution plots displayed]</span>
</pre></div>
</div>
</dd>
<dt>Customization Options:</dt><dd><p>To modify the analysis:</p>
<p>Parameter Space:
- Adjust NUMBER_SLIP_VALUES for different resolution
- Change LOWEST/LARGEST_SLIP_VALUE for different ranges
- Modify QPRIORS for different prior assumptions</p>
<p>Computational Settings:
- Increase NSAMPLES for better posterior resolution
- Adjust NUMBER_TIME_STEPS for temporal resolution
- Change QSTART for different MCMC initialization</p>
<p>Analysis Options:
- Enable plotting in RSF initialization (plotfigs=True)
- Add MySQL analysis for storage comparison
- Include reduced-order modeling for efficiency</p>
</dd>
<dt>Extended Analysis Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">problem</span> <span class="o">=</span> <span class="n">setup_problem</span><span class="p">()</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="c1"># Enable visualization</span>
<span class="gp">... </span>    <span class="n">problem</span><span class="o">.</span><span class="n">plotfigs</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="c1"># Compare storage formats</span>
<span class="gp">... </span>    <span class="n">json_time</span> <span class="o">=</span> <span class="n">perform_inference</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="s1">&#39;json&#39;</span><span class="p">,</span> <span class="n">NSAMPLES</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">mysql_time</span> <span class="o">=</span> <span class="n">perform_inference</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="s1">&#39;mysql&#39;</span><span class="p">,</span> <span class="n">NSAMPLES</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="c1"># Performance analysis</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;JSON: </span><span class="si">{</span><span class="n">json_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s, MySQL: </span><span class="si">{</span><span class="n">mysql_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Speedup: </span><span class="si">{</span><span class="n">mysql_time</span><span class="o">/</span><span class="n">json_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">x&quot;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="c1"># Save results</span>
<span class="gp">... </span>    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;rsf_posterior_analysis.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Resource Management:</dt><dd><p>The function includes proper resource cleanup:
- plt.show() displays all generated figures
- plt.close(‘all’) releases figure memory
- Prevents memory accumulation in batch processing</p>
</dd>
<dt>Error Handling:</dt><dd><p>Common issues and their resolution:
- Import errors: Verify module path setup
- Model convergence: Check parameter bounds and initialization
- Memory issues: Reduce NSAMPLES or NUMBER_SLIP_VALUES
- Visualization: Ensure matplotlib backend is configured</p>
</dd>
<dt>Integration with External Tools:</dt><dd><p>The results can be used for:
- Further statistical analysis with SciPy/StatsModels
- Parameter sensitivity studies
- Model comparison and validation
- Publication-quality figure generation
- Database storage of inference results</p>
</dd>
<dt>Scientific Impact:</dt><dd><p>This analysis framework enables:
- Quantitative earthquake fault parameter estimation
- Uncertainty quantification in geophysical models
- Validation of laboratory friction experiments
- Development of improved earthquake forecasting models</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Execution time varies with parameter space size and sample count</p></li>
<li><p>Visualization quality depends on matplotlib configuration</p></li>
<li><p>Consider parallel execution for large parameter studies</p></li>
<li><p>Results are displayed but not automatically saved</p></li>
<li><p>Memory usage scales with problem size and visualization</p></li>
</ul>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.main.perform_inference">
<span class="sig-prename descclassname"><span class="pre">src.main.</span></span><span class="sig-name descname"><span class="pre">perform_inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">problem</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_format</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/main.html#perform_inference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.main.perform_inference" title="Link to this definition"></a></dt>
<dd><p>Execute Bayesian parameter estimation using MCMC methods.</p>
<p>This function performs the complete Bayesian inference workflow for Rate and
State Friction parameter estimation. It configures data persistence, executes
MCMC sampling across the parameter space, and generates comprehensive
posterior analysis and visualization.</p>
<p>The function orchestrates the inference process by setting up data storage,
running systematic MCMC analysis for each characteristic slip distance,
and measuring performance for computational assessment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>problem</strong> (<a class="reference internal" href="#src.RSF.RSF" title="src.RSF.RSF"><em>RSF</em></a>) – Configured RSF problem instance containing:
- Parameter space and forward model
- Generated synthetic time series data
- MCMC configuration and prior specifications</p></li>
<li><p><strong>data_format</strong> (<em>str</em>) – Data storage format specification:
- ‘json’: JSON file storage for small to medium datasets
- ‘mysql’: MySQL database storage for large datasets
Must be supported by RSF data persistence layer.</p></li>
<li><p><strong>nsamples</strong> (<em>int</em>) – Number of MCMC samples per parameter value:
- Should be sufficient for convergence (typically 1000-10000)
- Includes automatic burn-in period (50% of samples)
- Higher values improve posterior accuracy but increase time</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Total execution time in seconds for complete inference analysis.</dt><dd><p>Includes data preparation, MCMC sampling, and visualization.
Useful for performance analysis and computational benchmarking.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<dl>
<dt>Inference Workflow:</dt><dd><ol class="arabic simple">
<li><p>Data Format Configuration:
- Sets problem.format to specified storage backend
- Configures persistence layer for data handling</p></li>
<li><p>MCMC Execution:
- Calls problem.inference() with sample count specification
- Performs systematic analysis across all Dc values
- Generates posterior distributions and convergence diagnostics</p></li>
<li><p>Performance Monitoring:
- Measures total execution time via &#64;measure_execution_time decorator
- Enables computational performance assessment</p></li>
</ol>
</dd>
<dt>Storage Format Details:</dt><dd><p>JSON Format:
- File-based storage in current directory
- Human-readable format, good for version control
- Suitable for datasets &lt; 100MB
- Fast for small to medium problem sizes
- Platform-independent storage</p>
<p>MySQL Format:
- Database storage with chunked insertion
- Suitable for large datasets and concurrent access
- Requires MySQL server configuration
- Better scalability for extensive parameter studies
- Supports advanced querying and data management</p>
</dd>
<dt>MCMC Analysis Details:</dt><dd><p>For each Dc value in the parameter space:
- Extracts relevant data segment from concatenated time series
- Initializes adaptive Metropolis-Hastings sampler
- Performs nsamples iterations with automatic burn-in
- Generates convergence diagnostics and acceptance statistics
- Creates posterior distribution visualizations</p>
</dd>
<dt>Performance Characteristics:</dt><dd><ul class="simple">
<li><p>Execution time scales as O(num_dc * nsamples * model_evaluation_time)</p></li>
<li><p>Memory usage depends on sample storage and plotting</p></li>
<li><p>I/O overhead varies significantly between storage formats</p></li>
<li><p>Parallel execution potential for multiple Dc values</p></li>
</ul>
</dd>
<dt>Output Generation:</dt><dd><p>The function produces comprehensive analysis results:
- MCMC trace plots showing parameter evolution
- Posterior probability density plots
- Convergence diagnostics and acceptance rates
- Animation files (if enabled) showing sampling evolution
- Console output with progress and performance metrics</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Setup and run inference</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">problem</span> <span class="o">=</span> <span class="n">setup_problem</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># JSON storage analysis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">json_time</span> <span class="o">=</span> <span class="n">perform_inference</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="s1">&#39;json&#39;</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;JSON analysis: </span><span class="si">{</span><span class="n">json_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># MySQL storage analysis (if database available)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mysql_time</span> <span class="o">=</span> <span class="n">perform_inference</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="s1">&#39;mysql&#39;</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MySQL analysis: </span><span class="si">{</span><span class="n">mysql_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Performance comparison</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">speedup</span> <span class="o">=</span> <span class="n">mysql_time</span> <span class="o">/</span> <span class="n">json_time</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Storage format speedup: </span><span class="si">{</span><span class="n">speedup</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">x&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="simple">
<dt>Quality Assessment:</dt><dd><p>Monitor these metrics for successful inference:
- Acceptance rates: typically 20-50% for good mixing
- Trace plot convergence: no obvious trends or drift
- Posterior smoothness: well-defined probability distributions
- Parameter recovery: posterior means near true values</p>
</dd>
<dt>Error Handling:</dt><dd><p>Potential issues and their handling:
- Data format errors: Invalid storage backend specification
- MCMC convergence failures: Poor mixing or divergence
- Storage backend errors: File permissions or database connectivity
- Memory issues: Large parameter spaces or sample counts</p>
</dd>
<dt>Optimization Strategies:</dt><dd><p>For large-scale analyses:
- Use MySQL storage for datasets &gt; 100MB
- Consider model reduction for faster evaluation
- Implement parallel MCMC for multiple Dc values
- Monitor memory usage and adjust sample counts
- Use preliminary runs to optimize MCMC parameters</p>
</dd>
<dt>Results Interpretation:</dt><dd><p>The analysis produces posterior distributions that quantify:
- Parameter estimation uncertainty
- Model sensitivity to different Dc values
- Quality of data fit and model adequacy
- Computational efficiency metrics</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Requires problem.data to be set before calling</p></li>
<li><p>Visualization windows may remain open after completion</p></li>
<li><p>Consider automated figure saving for batch processing</p></li>
<li><p>Results quality depends on nsamples and problem conditioning</p></li>
</ul>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.main.setup_problem">
<span class="sig-prename descclassname"><span class="pre">src.main.</span></span><span class="sig-name descname"><span class="pre">setup_problem</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/main.html#setup_problem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.main.setup_problem" title="Link to this definition"></a></dt>
<dd><p>Initialize and configure the Rate and State Friction analysis problem.</p>
<p>This function creates a comprehensive RSF analysis setup by initializing
the parameter space, configuring the forward model, and generating synthetic
time series data. The setup represents a complete earthquake fault mechanics
problem ready for Bayesian parameter estimation.</p>
<p>The function coordinates multiple components:
- RSF driver class with parameter space configuration
- Rate and State friction forward model
- Synthetic data generation with realistic noise</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Fully configured RSF problem instance containing:</dt><dd><ul class="simple">
<li><p>Parameter space (Dc values from LOWEST_SLIP_VALUE to LARGEST_SLIP_VALUE)</p></li>
<li><p>Initialized forward model (RateStateModel)</p></li>
<li><p>Generated synthetic time series data with noise</p></li>
<li><p>MCMC configuration (priors, starting values)</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#src.RSF.RSF" title="src.RSF.RSF">RSF</a></p>
</dd>
</dl>
<dl>
<dt>Configuration Details:</dt><dd><p>Parameter Space:
- NUMBER_SLIP_VALUES (5): Number of characteristic slip distances to analyze
- LOWEST_SLIP_VALUE (100 μm): Minimum Dc value for parameter sweep
- LARGEST_SLIP_VALUE (5000 μm): Maximum Dc value for parameter sweep
- Linear spacing between bounds for systematic coverage</p>
<p>Forward Model:
- NUMBER_TIME_STEPS (500): Temporal resolution for ODE integration
- Default rate and state parameters (a=0.011, b=0.014)
- Radiation damping enabled for physical realism
- Time range: 0-50 seconds with adaptive ODE solver</p>
<p>Bayesian Configuration:
- QSTART (1000 μm): Initial parameter value for MCMC chains
- QPRIORS: Uniform prior distribution [0, 10000] μm
- Prior bounds encompass expected parameter range</p>
</dd>
<dt>Data Generation Process:</dt><dd><ol class="arabic simple">
<li><p>Creates RSF driver with specified parameter configuration</p></li>
<li><p>Initializes RateStateModel with temporal discretization</p></li>
<li><p>Generates synthetic time series for each Dc value</p></li>
<li><p>Adds realistic noise to simulate experimental conditions</p></li>
<li><p>Concatenates data for systematic analysis</p></li>
</ol>
</dd>
<dt>Physical Interpretation:</dt><dd><p>The parameter range (100-5000 μm) represents realistic characteristic
slip distances for earthquake faults:
- Small Dc (100-500 μm): Velocity strengthening behavior
- Medium Dc (500-2000 μm): Transitional regime
- Large Dc (2000-5000 μm): Velocity weakening, stick-slip potential</p>
</dd>
<dt>Performance Characteristics:</dt><dd><ul class="simple">
<li><p>Data generation time: ~5-30 seconds (depends on NUMBER_SLIP_VALUES)</p></li>
<li><p>Memory usage: ~50-500 MB (scales with problem size)</p></li>
<li><p>Computation scales linearly with NUMBER_SLIP_VALUES</p></li>
<li><p>Forward model evaluation dominates computation time</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">problem</span> <span class="o">=</span> <span class="n">setup_problem</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parameter space: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">problem</span><span class="o">.</span><span class="n">dc_list</span><span class="p">)</span><span class="si">}</span><span class="s2"> Dc values&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data shape: </span><span class="si">{</span><span class="n">problem</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dc range: </span><span class="si">{</span><span class="n">problem</span><span class="o">.</span><span class="n">dc_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">problem</span><span class="o">.</span><span class="n">dc_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> μm&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Inspect generated data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segment_length</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">num_tsteps</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">dc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">problem</span><span class="o">.</span><span class="n">dc_list</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">start_idx</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">segment_length</span>
<span class="gp">... </span>    <span class="n">segment</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:</span><span class="n">start_idx</span> <span class="o">+</span> <span class="n">segment_length</span><span class="p">]</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dc=</span><span class="si">{</span><span class="n">dc</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">: RMS=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">segment</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="simple">
<dt>Customization:</dt><dd><p>To modify the problem setup:
- Adjust constants at module level for different parameter ranges
- Modify RateStateModel parameters (a, b, time range)
- Change temporal resolution via NUMBER_TIME_STEPS
- Update prior bounds for different parameter exploration</p>
</dd>
<dt>Error Handling:</dt><dd><ul class="simple">
<li><p>Forward model initialization errors propagate to caller</p></li>
<li><p>Data generation failures will raise exceptions</p></li>
<li><p>Parameter validation handled by RSF class</p></li>
<li><p>Consider wrapping in try-catch for production use</p></li>
</ul>
</dd>
<dt>Validation:</dt><dd><p>Quality checks for generated problem:
- Verify data array dimensions match expected size
- Check parameter bounds are physically reasonable
- Ensure forward model converges for all Dc values
- Validate noise characteristics in synthetic data</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Generated data represents “ground truth” with known parameters</p></li>
<li><p>Same random seed produces identical synthetic datasets</p></li>
<li><p>Problem instance is ready for immediate inference analysis</p></li>
<li><p>Memory usage scales with NUMBER_SLIP_VALUES * NUMBER_TIME_STEPS</p></li>
</ul>
</div>
</dd></dl>

</section>
<section id="module-src.mysql_save_load">
<span id="src-mysql-save-load-module"></span><h2>src.mysql_save_load module<a class="headerlink" href="#module-src.mysql_save_load" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="src.mysql_save_load.load_object">
<span class="sig-prename descclassname"><span class="pre">src.mysql_save_load.</span></span><span class="sig-name descname"><span class="pre">load_object</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">host</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">password</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">database</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mysql_save_load.html#load_object"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mysql_save_load.load_object" title="Link to this definition"></a></dt>
<dd><p>Load numerical data from a MySQL database and return as a NumPy array.</p>
<p>This function retrieves all numerical data previously stored using the save_object
function from the MySQL database. The data is returned as a flattened NumPy array
maintaining the original insertion order based on the sequential ID field.</p>
<p>The function connects to the specified MySQL database, executes a SELECT query
to retrieve all values from the ‘my_table’ table, and processes the results
into a convenient NumPy array format for further analysis or computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>host</strong> (<em>str</em>) – MySQL server hostname or IP address (e.g., ‘localhost’, ‘192.168.1.100’).
Must be the same server where data was previously saved.</p></li>
<li><p><strong>user</strong> (<em>str</em>) – MySQL username with SELECT privileges on the specified database.</p></li>
<li><p><strong>password</strong> (<em>str</em>) – Password for the MySQL user account.</p></li>
<li><p><strong>database</strong> (<em>str</em>) – Name of the MySQL database containing the stored data.
Must be the same database used in save_object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A 1D NumPy array containing all numerical values from the database,</dt><dd><p>ordered by their sequential ID (insertion order). Returns an empty
array if no data exists in the table.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>mysql.connector.Error</strong> – If database connection fails, authentication is invalid,
    table doesn’t exist, or SQL execution encounters errors.</p></li>
<li><p><strong>mysql.connector.ProgrammingError</strong> – If the ‘my_table’ table doesn’t exist in the database.</p></li>
<li><p><strong>MemoryError</strong> – If the dataset is too large to fit in available memory.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Data Format:</dt><dd><ul class="simple">
<li><p>Returns data as numpy.float64 array by default</p></li>
<li><p>Maintains the original order of data insertion (sorted by ID)</p></li>
<li><p>Flattened to 1D array regardless of original data structure</p></li>
<li><p>Missing or NULL values are handled according to NumPy’s default behavior</p></li>
</ul>
</dd>
<dt>Performance Considerations:</dt><dd><ul class="simple">
<li><p>Loads entire dataset into memory at once</p></li>
<li><p>For very large datasets, consider implementing pagination or streaming</p></li>
<li><p>Query performance depends on table size and database indexing</p></li>
<li><p>Network transfer time increases with data volume</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load previously saved data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loaded_data</span> <span class="o">=</span> <span class="n">load_object</span><span class="p">(</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="s1">&#39;myuser&#39;</span><span class="p">,</span> <span class="s1">&#39;mypass&#39;</span><span class="p">,</span> <span class="s1">&#39;mydb&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">loaded_data</span><span class="p">)</span><span class="si">}</span><span class="s2"> data points&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data type: </span><span class="si">{</span><span class="n">loaded_data</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load and analyze data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">measurements</span> <span class="o">=</span> <span class="n">load_object</span><span class="p">(</span><span class="s1">&#39;db.example.com&#39;</span><span class="p">,</span> <span class="s1">&#39;analyst&#39;</span><span class="p">,</span> <span class="s1">&#39;secure123&#39;</span><span class="p">,</span> <span class="s1">&#39;experiments&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">measurements</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">measurements</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Std Dev: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">measurements</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Range: [</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">measurements</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">measurements</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No data found in database&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Check for empty table</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">load_object</span><span class="p">(</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="s1">&#39;pass&#39;</span><span class="p">,</span> <span class="s1">&#39;testdb&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Table is empty or doesn&#39;t exist&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl>
<dt>Security Notes:</dt><dd><ul class="simple">
<li><p>Uses read-only SELECT queries (safe for data integrity)</p></li>
<li><p>Credentials are passed directly; consider using environment variables</p></li>
<li><p>Ensure proper database user permissions (SELECT on target table)</p></li>
<li><p>Connection uses default MySQL encryption settings</p></li>
</ul>
</dd>
<dt>Database Compatibility:</dt><dd><ul class="simple">
<li><p>Expects table structure created by save_object function</p></li>
<li><p>Compatible with MySQL 5.7+ and MariaDB 10.2+</p></li>
<li><p>Requires ‘my_table’ table with ‘value’ column</p></li>
<li><p>ID column is used for ordering but not returned in results</p></li>
</ul>
</dd>
<dt>Memory Management:</dt><dd><ul class="simple">
<li><p>Fetches all data at once using fetchall()</p></li>
<li><p>For large datasets, monitor memory usage</p></li>
<li><p>Consider using fetchmany() for memory-constrained environments</p></li>
<li><p>NumPy array creation may temporarily double memory usage</p></li>
</ul>
</dd>
<dt>Error Handling:</dt><dd><ul class="simple">
<li><p>Connection errors are propagated to caller</p></li>
<li><p>Empty tables return empty NumPy array (not None)</p></li>
<li><p>Database connection is always properly closed</p></li>
<li><p>Cursor cleanup ensures no resource leaks</p></li>
</ul>
</dd>
<dt>Usage Patterns:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Complete save/load cycle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">original_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mf">3.3</span><span class="p">,</span> <span class="mf">4.4</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">save_object</span><span class="p">(</span><span class="n">original_data</span><span class="p">,</span> <span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="s1">&#39;pass&#39;</span><span class="p">,</span> <span class="s1">&#39;mydb&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">retrieved_data</span> <span class="o">=</span> <span class="n">load_object</span><span class="p">(</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="s1">&#39;pass&#39;</span><span class="p">,</span> <span class="s1">&#39;mydb&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">original_data</span><span class="p">,</span> <span class="n">retrieved_data</span><span class="p">[</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">original_data</span><span class="p">):])</span>  <span class="c1"># True</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Data validation after loading</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">load_object</span><span class="p">(</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="s1">&#39;pass&#39;</span><span class="p">,</span> <span class="s1">&#39;mydb&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Data should be 1-dimensional&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="s2">&quot;Data should be float64&quot;</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.mysql_save_load.save_object">
<span class="sig-prename descclassname"><span class="pre">src.mysql_save_load.</span></span><span class="sig-name descname"><span class="pre">save_object</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">host</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">password</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">database</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mysql_save_load.html#save_object"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mysql_save_load.save_object" title="Link to this definition"></a></dt>
<dd><p>Save numerical data to a MySQL database in batched chunks for efficient storage.</p>
<p>This function stores numerical data (typically NumPy arrays or lists) into a MySQL
database table with automatic chunking for memory efficiency and performance optimization.
The function creates the table if it doesn’t exist and automatically assigns sequential
IDs to maintain data order and integrity.</p>
<p>The chunking mechanism is particularly useful for large datasets that might exceed
MySQL’s maximum packet size or cause memory issues. Each chunk is inserted as a
single transaction for better performance compared to individual row insertions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>array-like</em>) – Numerical data to be saved. Can be a NumPy array, list,
or any iterable containing numerical values. Will be converted
to float type during insertion.</p></li>
<li><p><strong>host</strong> (<em>str</em>) – MySQL server hostname or IP address (e.g., ‘localhost’, ‘192.168.1.100’).</p></li>
<li><p><strong>user</strong> (<em>str</em>) – MySQL username with INSERT privileges on the specified database.</p></li>
<li><p><strong>password</strong> (<em>str</em>) – Password for the MySQL user account.</p></li>
<li><p><strong>database</strong> (<em>str</em>) – Name of the MySQL database where data will be stored.
Database must exist before calling this function.</p></li>
<li><p><strong>chunk_size</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of data points to insert per batch operation.
Larger chunks improve performance but use more memory.
Defaults to 5000. Adjust based on data size and memory constraints.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mysql.connector.Error</strong> – If database connection fails, authentication is invalid,
    or SQL execution encounters errors.</p></li>
<li><p><strong>ValueError</strong> – If data contains non-numerical values that cannot be converted to float.</p></li>
<li><p><strong>MemoryError</strong> – If chunk_size is too large for available memory.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Database Schema:</dt><dd><p>Creates table ‘my_table’ with the following structure:
- id (INT PRIMARY KEY): Sequential identifier starting from 1
- value (FLOAT): The numerical data value</p>
</dd>
<dt>Performance Considerations:</dt><dd><ul class="simple">
<li><p>Uses batched INSERT statements to minimize database round trips</p></li>
<li><p>Automatically determines starting ID to append to existing data</p></li>
<li><p>Commits all changes in a single transaction for consistency</p></li>
<li><p>Chunk size can be tuned for optimal performance vs. memory trade-off</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Save a NumPy array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">save_object</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="s1">&#39;myuser&#39;</span><span class="p">,</span> <span class="s1">&#39;mypass&#39;</span><span class="p">,</span> <span class="s1">&#39;mydb&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Save with custom chunk size for large datasets</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">large_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1000000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">save_object</span><span class="p">(</span><span class="n">large_data</span><span class="p">,</span> <span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="s1">&#39;myuser&#39;</span><span class="p">,</span> <span class="s1">&#39;mypass&#39;</span><span class="p">,</span> <span class="s1">&#39;mydb&#39;</span><span class="p">,</span> <span class="n">chunk_size</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Save a simple list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">measurements</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">3.4</span><span class="p">,</span> <span class="mf">5.6</span><span class="p">,</span> <span class="mf">7.8</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">save_object</span><span class="p">(</span><span class="n">measurements</span><span class="p">,</span> <span class="s1">&#39;db.example.com&#39;</span><span class="p">,</span> <span class="s1">&#39;analyst&#39;</span><span class="p">,</span> <span class="s1">&#39;secure123&#39;</span><span class="p">,</span> <span class="s1">&#39;experiments&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="simple">
<dt>Security Notes:</dt><dd><ul class="simple">
<li><p>Uses parameterized queries to prevent SQL injection</p></li>
<li><p>Credentials are passed directly; consider using environment variables</p></li>
<li><p>Ensure proper database user permissions (INSERT, SELECT on target table)</p></li>
<li><p>Connection uses default MySQL encryption settings</p></li>
</ul>
</dd>
<dt>Data Integrity:</dt><dd><ul class="simple">
<li><p>Each save operation appends to existing data (preserves previous records)</p></li>
<li><p>Sequential IDs maintain insertion order for data retrieval</p></li>
<li><p>Single transaction ensures all-or-nothing behavior for each function call</p></li>
<li><p>Existing data is never modified, only new records are added</p></li>
</ul>
</dd>
<dt>Troubleshooting:</dt><dd><ul class="simple">
<li><p>Verify database exists and user has appropriate permissions</p></li>
<li><p>Check network connectivity to MySQL server</p></li>
<li><p>Ensure chunk_size doesn’t exceed MySQL’s max_allowed_packet setting</p></li>
<li><p>Monitor memory usage for very large datasets</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-src.setup_path">
<span id="src-setup-path-module"></span><h2>src.setup_path module<a class="headerlink" href="#module-src.setup_path" title="Link to this heading"></a></h2>
<p>Python Path Setup Module</p>
<p>Adds the project root directory to sys.path to enable imports from anywhere
within the project structure. Simply import this module at the beginning
of any script to ensure consistent import behavior.</p>
<dl class="simple">
<dt>Usage:</dt><dd><p>import setup_path  # Must be first import
from src.imports import *  # Now works from any location</p>
</dd>
</dl>
</section>
<section id="module-src">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-src" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modules.html" class="btn btn-neutral float-left" title="Bayesian-Markov-chain-Monte-Carlo" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Saumik Dana.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>